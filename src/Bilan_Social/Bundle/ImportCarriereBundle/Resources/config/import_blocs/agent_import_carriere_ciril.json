{
	"to_entity" : "Bilan_Social\\Bundle\\ApaBundle\\Entity\\BilanSocialAgent",
	"bloc_name" : "agent_ciril",
	"default_in_params":{
		"annee_n":"2016",
		"annee_n_31_12":"31/12/1/2016"
	},
	"fields":{
		"nom":{
			"left_key":"nom",
			"right_key":"lbNom",
			"type":"string"
		},
		"prenom":{
			"left_key":"prenom",
			"right_key":"lbPren",
			"type":"string"
		},
		"date_naiss":{
			"left_key":"date_naissance",
			"right_key":"LbDateNais",
			"type":"date",
			"transform":{
				"name":"date_format",
				"format_to":"m/Y",
				"format_from":"Y-m-d"
			}
		},
		"absences":{
			"left_key":"absences",
			"right_key":"AbsenceArretAgent",
			"type":"bloc",
			"collection":true,
			"config_name":"absences_ciril",
			"bloc_name":"absences_ciril",
			"condition":{
				"left_value":{
					"from":"sub_bloc",
					"field":"date_absence"
				},
				"operator":">=",
				"right_value":{
					"from":"in_param",
					"field":"annee_n"
				}
			}
		},
		"sexe":{
			"left_key":"sexe",
			"right_key":"cdSexe",
			"type":"integer",
			"transform":{
				"name":"get_from_ref",
				"ref_name":"ref_sexe",
				"get_col":"cd_sexe",
				"by_col":"code"
			}
		},
		"handicap":{
			"left_key":"handicap",
			"right_key":"blBoeth",
			"type":"boolean",
			"transform":{
				"name":"matching_swap",
				"swaping_board":{
					"11":1,
					"":0,
					"default_value":null
				}
			}
		},
		"temps_complet":{
			"left_key":"type_temps_travail",
			"right_key":"blTempcomp",
			"type":"boolean",
			"transform":{
				"name":"get_from_ref",
				"ref_name":"ref_temps_travail",
				"get_col":"cd_temps_comp",
				"by_col":"code"
			}
		},
		"temps_plein":{
			"left_key":"type_temps_travail",
			"right_key":"blTempplein",
			"type":"boolean",
			"transform":{
				"name":"get_from_ref",
				"ref_name":"ref_temps_travail",
				"get_col":"cd_temps_plein",
				"by_col":"code"
			}
		},
		"statut":{
			"left_key":"situation_type_contrat",
			"right_key":"refStatut",
			"type":"integer",
			"back_ref":false,
			"transform":[
				{
					"name":"get_from_ref",
					"ref_name":"ref_type_contrat",
					"get_col":"cd_type_contrat",
					"by_col":"code"
				},
				{
					"name":"get_from_base_ref",
					"entity_field":"cdStat",
					"by_col":"CD_STAT",
					"from_repository":"ReferencielBundle:RefStatut"
				}
			]
		},
		"type_cdd":{
			"left_key":"situation_type_contrat",
			"right_key":"RefTypeCdd",
			"type":"integer",
			"back_ref":false,
			"transform":[
				{
					"name":"get_from_ref",
					"ref_name":"ref_type_contrat",
					"get_col":"cd_type_cdd",
					"by_col":"code"
				},
				{
					"name":"get_from_base_ref",
					"entity_field":"cdTypecdd",
					"by_col":"CD_TYPECDD",
					"from_repository":"ReferencielBundle:RefTypeCdd"
				}
			]
		},
		"type_contrat_nonperm":{
			"left_key":"type_contrat",
			"right_key":"RefEmploiNonPermanent",
			"type":"integer",
			"back_ref":false,
			"transform":[
				{
					"name":"get_from_ref",
					"ref_name":"ref_type_contrat",
					"get_col":"cd_type_cdd",
					"by_col":"code"
				},
				{
					"name":"get_from_base_ref",
					"entity_field":"cdEmplnonperm",
					"by_col":"CD_EMPLNONPERM",
					"from_repository":"ReferencielBundle:RefEmploiNonPermanent"
				}
			]
		},
		"entre_coll_in_annee":{
			"left_key":"date_entree_collectivite",
			"right_key":"BlAgenarriannecoll",
			"type":"boolean",
			"transform":[
				{
					"name":"date_format",
					"format_to":"Y",
					"format_from":"Y-m-d"
				},
				{
					"name":"comparison",
					"if_else":[
						{
							"operator":">=",
							"right_value":{
								"from":"in_param",
								"field":"annee_n"
							},
							"value_if":1,
							"value_else":0
						}
					]
				}
			]
		},
		"modalite_entre_coll_in_annee":{
			"left_key":"modalite_entree_collectivite",
			"right_key":"RefMotifArrivee",
			"type":"string",
			"back_ref":false,
			"condition":{
				"left_value":{
					"from":"vessel",
					"field":"entre_coll_in_annee"
				},
				"operator":"==",
				"right_value":1
			},
			"transform":[
				{
					"name":"get_from_ref",
					"ref_name":"ref_modalite_entre_coll",
					"get_col":"cd_moda_entre_coll",
					"by_col":"code"
				},
				{
					"name":"get_from_base_ref",
					"entity_field":"cdMotiarri",
					"by_col":"CD_MOTIARRI",
					"from_repository":"ReferencielBundle:RefMotifArrivee"
				}
			]
		},
		"sortie_coll_in_annee":{
			"left_key":"date_sortie_collectivite",
			"right_key":"LbDatedepacoll",
			"type":"date",
			"transform":[
				{
					"name":"date_format",
					"format_to":"d/m/Y",
					"format_from":"Y-m-d"
				},
				{
					"name":"comparison",
					"if_else":[
						{
							"operator":"<=",
							"right_value":{
								"from":"in_param",
								"field":"annee_n_31_12"
							},
							"value_if":"self_data_value",
							"value_else":null
						}
					]
				},
				{
					"name":"date_format",
					"format_to":"d/m/Y",
					"format_from":"d/m/Y",
					"to_date_interface":true
				}
			]
		},
		"modalite_sortie_coll_in_annee":{
			"left_key":"modalite_sortie_collectivite",
			"right_key":"RefMotifDepart",
			"type":"string",
			"back_ref":false,
			"condition":{
				"left_value":{
					"from":"vessel",
					"field":"sortie_coll_in_annee"
				},
				"operator":"is_not_null"
			},
			"transform":[
				{
					"name":"get_from_ref",
					"ref_name":"ref_modalite_sortie_coll",
					"get_col":"cd_moda_sortie_coll",
					"by_col":"code"
				},
				{
					"name":"get_from_base_ref",
					"entity_field":"cdMotidepa",
					"by_col":"CD_MOTIDEPA",
					"from_repository":"ReferencielBundle:RefMotifDepart"
				}
			]
		},
		"renumeration_31_12":{
			"left_key":"date_sortie_collectivite",
			"right_key":"BlAgenremu3112",
			"type":"boolean",
			"transform":[
				{
					"name":"date_format",
					"format_to":"d/m/Y",
					"format_from":"Y-m-d"
				},
				{
					"name":"comparison",
					"if_else":[
						{
							"operator":"is_null",
							"value_if":1,
							"value_else":0
						},
						{
							"operator":"<=",
							"right_value":{
								"from":"in_param",
								"field":"annee_n_31_12"
							},
							"value_if":0,
							"value_else":1
						}
					]
				}
			]
		},
		"renumeration_anne":{
			"left_key":"date_sortie_coll",
			"right_key":"BlAgenremuanne",
			"type":"boolean",
			"transform":[
				{
					"name":"same_as_field",
					"as_field":"renumeration_31_12"
				}
			]
		},
		"grade":{
			"left_key":"metier",
			"right_key":"RefGrade",
			"type":"string",
			"back_ref":false,
			"transform":[
                                {
					"name":"get_from_base_ref",
					"entity_field":"cdMotiBcCiril",
					"by_col":"CD_MOTI_BC_CIRIL",
					"from_repository":"ReferencielBundle:RefGrade",
					"operator":"like"
				},{
					"name":"comparison",
					"if_else":[
						{
							"operator":"is_null",
							"value_if":null,
							"value_else":"self_data_value"
						},{
							"operator":"is_empty",
							"value_if":null,
							"value_else":"self_data_value"
						}
					]
				}
			]
		},
		"grade_2":{
			"left_key":"grade",
			"right_key":"RefGrade",
			"type":"string",
			"back_ref":false,
			"condition":{
				"left_value":{
					"from":"vessel",
					"field":"grade"
				},
				"operator":"is_null"
			},
			"transform":[
                                {
					"name":"get_from_base_ref",
					"entity_field":"cdMotiN4ds",
					"by_col":"CD_MOTI_N4DS",
					"from_repository":"ReferencielBundle:RefGrade",
					"operator":"like"
				},{
					"name":"comparison",
					"if_else":[
						{
							"operator":"is_null",
							"value_if":null,
							"value_else":"self_data_value"
						},{
							"operator":"is_empty",
							"value_if":null,
							"value_else":"self_data_value"
						}
					]
				}
			]
		},
		"formations":{
			"left_key":"formations",
			"right_key":"FormationAgent",
			"type":"bloc",
			"collection":true,
			"config_name":"formations_ciril",
			"bloc_name":"formations_ciril"
		},
		"gpeec":{
			"left_key":"metier",
			"right_key":"gpeec",
			"type":"bloc",
			"transform":[
				{
					"name":"get_from_base_ref",
					"entity_field":"cdMetier",
					"by_col":"CD_METIER",
					"from_repository":"ReferencielBundle:RefMetier",
					"operator":"=="
				},
				{
					"name":"to_entity",
					"entity_class":"Bilan_Social\\Bundle\\ApaBundle\\Entity\\Gpeec",
					"set_fields":[
						{
							"entity_field":"refMetier",
							"set_data":{
								"from":"self_data_value"
							}
						},{
							"entity_field":"idDomaineDiplomeGpeec",
							"set_data":{
								"from":"vessel",
                                                                "field":"niveau_diplome"
							}
						}
					]
				}
			]
		},
                "pourcentage_temps_partiel":{
			"left_key":"duree_travail_hebdo",
			"right_key":"RefPourcentageTempaPartiel",
			"type":"string",
			"back_ref":false,
			"condition":{
				"left_value":{
					"from":"vessel",
					"field":"temps_plein"
				},
				"operator":"==",
                                "right_value":0
			},
			"transform":[
                                {
					"name":"comparison",
					"if_else":[
						{
							"operator":"<",
                                                        "right_value":"2800",
							"value_if":"PTPSP001",
							"value_else":null
						},{
							"operator":"<",
                                                        "right_value":"3150",
							"value_if":"PTPSP002",
							"value_else":"PTPSP003"
						}
					]
				},{
					"name":"get_from_base_ref",
					"entity_field":"cdPourtemppart",
					"by_col":"CD_POURTEMPPART",
					"from_repository":"ReferencielBundle:RefPourcentageTempaPartiel",
					"operator":"like"
				}
			]
		},
                "niveau_diplome":{
			"left_key":"niveau_diplome",
			"type":"string",
			"back_ref":false,
			"transform":[
				{
					"name":"get_from_ref",
					"ref_name":"ref_domaine_diplome",
					"get_col":"cd_domaine_diplome",
					"by_col":"code"
				},
				{
					"name":"get_from_base_ref",
					"entity_field":"cdDomaineDiplome",
					"from_repository":"ReferencielBundle:RefDomaineDiplome"
				}
			]
		}
	}
}