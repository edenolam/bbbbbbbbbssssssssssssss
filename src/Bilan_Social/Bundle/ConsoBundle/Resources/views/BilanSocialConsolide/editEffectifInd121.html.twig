

    {% if formEffectif121 is defined %}
        {% set bilan_social_consolide = formEffectif121.vars.data %}
        {{ form_start(formEffectif121) }}

        <h5>
            Champ : le tableau qui suit concerne les agents contractuels sur un emploi permanent
            Remarque importante : les agents occupant un emploi fonctionnel doivent être uniquement comptabilisés dans leurs cadres d'emplois respectifs.
        </h5>

        <table width="100%" id="ind121Table" class="table ind121 table-striped table-hover table-bordered">
            <thead>
                <tr entete="1">
                    <th width="10%" rowspan="4"></th>
                    <th colspan="9" style="text-align: center">Type de contrats</th>
                    <th rowspan="2" colspan="15" style="text-align: center"></th>
                </tr>
                <tr entete="1">
                    <th colspan="8" style="text-align: center">Agents en CDD</th>
                    <th rowspan="4" style="text-align: center">Agents en CDI</th>
                </tr>
                <tr entete="1">
                    <th colspan="7" style="text-align: center">Article 3 de la Loi du 26 janvier 84, modifié par la loi n° 2012-347 du 12 mars 2012-art. 41(V))</th>
                    <th rowspan="3" style="text-align: center">Autres contractuels (articles 38, 38bis, 47,136...)</th>
                    <th class="filiTable" rowspan="3" style="text-align: center">Total</th>
                    <th rowspan="2" colspan="3" style="text-align: center">Tous emplois exerçant à </th>
                    <th rowspan="2" colspan="4" style="text-align: center">Ancienneté dans la collectivité</th>
                    <th rowspan="2" colspan="3" style="text-align: center">CDI</th>
                    <th rowspan="2" colspan="3" style="text-align: center">CDD</th>
                    <th rowspan="3" style="text-align: center">Total CDI + CDD</th>
                </tr>
                <tr entete="1">
                    <th style="text-align: center">Article 3-1</th>
                    <th style="text-align: center">Article 3-2</th>
                    <th style="text-align: center">Article 3-3, 1°</th>
                    <th style="text-align: center">Article 3-3, 2°</th>
                    <th style="text-align: center">Article 3-3, 3°</th>
                    <th style="text-align: center">Article 3-3, 4°</th>
                    <th style="text-align: center">Article 3-3, 5°</th>
                </tr>
                <tr entete="1">
                    <th style="text-align: center">FILIERES</th>
                    <th style="text-align: center"><span title="Remplaçants" class="buttoninfo"></span></th>
                    <th style="text-align: center"><span title="Affectés sur un poste vacant" class="buttoninfo"></span></th>
                    <th style="text-align: center"><span title="Pas de cadre d'emplois existant" class="buttoninfo"></span> </th>
                    <th style="text-align: center"><span title="Catégorie A selon les fonctions ou pour des besoins de service" class="buttoninfo"></span></th>
                    <th style="text-align: center"><span title="Secrétaire de mairie dans les communes et groupements de communes de moins de 1000 habitants" class="buttoninfo"></span></th>
                    <th style="text-align: center"><span title="Temps non complet des communes et groupements de communes de moins de 1000 hab., lorsque la quotité de temps de travail est inférieure à 50 %" class="buttoninfo"></span></th>
                    <th style="text-align: center"><span title="Communes de moins de 2000 hab. et groupements de communes de moins de 10 000 hab. dont la création ou la suppression dépend de la décision d'une autorité qui s'impose à la collectivité" class="buttoninfo"></span></th>
                    <th style="text-align: center">Temps complet</th>
                    <th style="text-align: center">Temps non complet</th>
                    <th style="text-align: center">Total temps complet + temps non complet</th>
                    <th style="text-align: center">Moins de 3 ans</th>
                    <th style="text-align: center">de 3 ans à moins de 6 ans</th>
                    <th style="text-align: center">6 ans et plus</th>
                    <th style="text-align: center">Total ancienneté</th>
                    <th style="text-align: center">Hommes</th>
                    <th style="text-align: center">Femmes</th>
                    <th style="text-align: center">Total CDI</th>
                    <th style="text-align: center">Hommes</th>
                    <th style="text-align: center">Femmes</th>
                    <th style="text-align: center">Total CDD</th>
                </tr>
            </thead>
            <tbody class="ind_table_totaux">
                {% for tagF in filieres %}
                    <tr id="entetFil" hide="1" idFili="{{ tagF.idFili }}" cdFili="{{ tagF.cdFili }}" style="text-align: center;" >
                        <td colspan="25">
                            &nbsp;&nbsp;&nbsp;&nbsp;{{ tagF.lbFili }}
                            {% for key,tot in arrayTotalFiliere %}
                                {% if(key == tagF.idFili) %}
                                    <span class="alerteConso">[{% if(tot) == null %} 0 {% else %} {{ tot }} {% endif %}]</span>
                                {% endif %}
                            {% endfor %}
                            <div style="float: right;">
                                {% if indicateur_precedent is defined and indicateur_precedent is not null %}
                                    <span style="margin-right: 28px;">{{ include('ConsoBundle:BilanSocialConsolide:modals_ind_precedents/btn_modal.html.twig', { 'indicateur_precedent': indicateur_precedent, 'name' : "121_" ~ tagF.idFili }) }}</span>
                                    {{ include('ConsoBundle:BilanSocialConsolide:modals_ind_precedents/modal_121.html.twig', { 'indicateur_precedent': indicateur_precedent, 'id_filiere': tagF.idFili }) }}
                                {% endif %}

                                {% if idFili == tagF.idFili%}
                                    <input class="buttonmoins" type="button" id="toggle121_{{ tagF.idFili}}"
                                        onclick="toggleFiliere121(this, {{ tagF.idFili}})">
                                {% endif%}

                                {% if idFili != tagF.idFili%}
                                    <input class="buttonplus" type="button" id="toggle121_{{ tagF.idFili}}"
                                        onclick="toggleFiliere121(this, {{ tagF.idFili}})">
                                {% endif%}
                            </div>
                        </td>
                    </tr>

                    {% if idFili == tagF.idFili%}
                        {% for tag in formEffectif121.ind121sTemp %}
                            {% set row_data = tag.vars.value %}
                            {% set total_fili_type_contrat = row_data.r1211 + row_data.r1212 + row_data.r1213 + row_data.r1214 + row_data.r1215 + row_data.r1216 + row_data.r1217 + row_data.r1218 + row_data.r12118 %}
                            {% set total_fili_temps = row_data.r1219 + row_data.r12110 %}
                            {% set total_fili_anci = row_data.r12111 + row_data.r12112 + row_data.r12113 %}
                            {% set total_fili_cdi = row_data.r12114 + row_data.r12115 %}
                            {% set total_fili_cdd = row_data.r12116 + row_data.r12117 %}
                            {% set total_fili_cdi_cdd = row_data.r12114 + row_data.r12115 + row_data.r12116 + row_data.r12117 %}
                            <tr  cdFili="{{ tag.cdFili.vars.value }}"
                                 id="121trCE_{{tag.refCadreEmploi.vars.value}}"
                                 idTrFili="{{ tag.idFili.vars.value }}"
                                 idCe="{{ tag.refCadreEmploi.vars.value }}"
                                 >
                                <td>
                                    {{ form_widget(tag.refCadreEmploi) }}
                                    {{ form_widget(tag.idFili) }}
                                    {{ form_widget(tag.cdFili) }}
                                    {{ form_widget(tag.lbFili) }}
                                    {{ tag.refCadreEmploi.vars.data.lbCadrempl }}

                                </td>
                                <td id="r1211" style="text-align: center" data-col-group='row_total_type_contrat'>{{ form_widget(tag.r1211) }}</td>
                                <td id="r1212" style="text-align: center" data-col-group='row_total_type_contrat'>{{ form_widget(tag.r1212) }}</td>
                                <td id="r1213" style="text-align: center" data-col-group='row_total_type_contrat'>{{ form_widget(tag.r1213) }}</td>
                                <td id="r1214" style="text-align: center" data-col-group='row_total_type_contrat'>{{ form_widget(tag.r1214) }}</td>
                                <td id="r1215" style="text-align: center" data-col-group='row_total_type_contrat'>{{ form_widget(tag.r1215) }}</td>
                                <td id="r1216" style="text-align: center" data-col-group='row_total_type_contrat'>{{ form_widget(tag.r1216) }}</td>
                                <td id="r1217" style="text-align: center" data-col-group='row_total_type_contrat'>{{ form_widget(tag.r1217) }}</td>
                                <td id="r1218" style="text-align: center" data-col-group='row_total_type_contrat'>{{ form_widget(tag.r1218) }}</td>
                                <td id="r12118" style="text-align: center" data-col-group='row_total_type_contrat'>{{ form_widget(tag.r12118) }}</td>
                                <td class="filiTable" id="lineTot1" style="text-align: center" data-col-id='row_total_type_contrat'>{{ total_fili_type_contrat }}</td>
                                <td id="r1219" style="text-align: center" data-col-group='row_total_temps'>{{ form_widget(tag.r1219) }}</td>
                                <td id="r12110" style="text-align: center" data-col-group='row_total_temps'>{{ form_widget(tag.r12110) }}</td>
                                <td style="text-align: center" data-col-id='row_total_temps'>{{ total_fili_temps }}</td>
                                <td id="r12111" style="text-align: center" data-col-group='row_total_anci'>{{ form_widget(tag.r12111) }}</td>
                                <td id="r12112" style="text-align: center" data-col-group='row_total_anci'>{{ form_widget(tag.r12112) }}</td>
                                <td id="r12113" style="text-align: center" data-col-group='row_total_anci'>{{ form_widget(tag.r12113) }}</td>
                                <td style="text-align: center" data-col-id='row_total_anci'>{{ total_fili_anci }}</td>
                                <td id="r12114" style="text-align: center" data-col-group='row_total_cdi'>{{ form_widget(tag.r12114) }}</td>
                                <td id="r12115" style="text-align: center" data-col-group='row_total_cdi'>{{ form_widget(tag.r12115) }}</td>
                                <td style="text-align: center" data-col-id='row_total_cdi' data-col-group='row_total_cdi_cdd'>{{ total_fili_cdi }}</td>
                                <td id="r12116" style="text-align: center" data-col-group='row_total_cdd'>{{ form_widget(tag.r12116) }}</td>
                                <td id="r12117" style="text-align: center" data-col-group='row_total_cdd'>{{ form_widget(tag.r12117) }}</td>
                                <td style="text-align: center" data-col-id='row_total_cdd' data-col-group='row_total_cdi_cdd'>{{ total_fili_cdd }}</td>
                                <td style="text-align: center" data-col-id='row_total_cdi_cdd'>{{ total_fili_cdi_cdd }}</td>

                            </tr>

                            {{ form_widget(tag.newFiliere) }}
                            {{ form_widget(tag.idFili) }}
                            {{ form_widget(tag.cdFili) }}
                            {{ form_widget(tag.lastFiliere) }}

                        {% endfor %}
                        {% set total_fili = bilan_social_consolide.getIndPileForBy('ind121sTemp',['refCadreEmploi','refFiliere','idFili'],idFili) %}
                        {% set total_fili_type_contrat = total_fili.r1211 + total_fili.r1212 + total_fili.r1213 + total_fili.r1214 + total_fili.r1215 + total_fili.r1216 + total_fili.r1217 + total_fili.r1218 + total_fili.r12118 %}
                        {% set total_fili_temps = total_fili.r1219 + total_fili.r12110 %}
                        {% set total_fili_anci = total_fili.r12111 + total_fili.r12112 + total_fili.r12113 %}
                        {% set total_fili_cdi = total_fili.r12114 + total_fili.r12115 %}
                        {% set total_fili_cdd = total_fili.r12116 + total_fili.r12117 %}
                        {% set total_fili_cdi_cdd = total_fili.r12114 + total_fili.r12115 + total_fili.r12116 + total_fili.r12117 %}
                        <tr class="filiTable row_totaux" id="totalFil" cdFili="{{ tagF.cdFili}}">
                            <td idFili="{{ tagF.idFili}}"><b>Total {{ tagF.lbFili }} </b></td>
                            <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_fili.r1211 }}</td>
                            <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_fili.r1212 }}</td>
                            <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_fili.r1213 }}</td>
                            <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_fili.r1214 }}</td>
                            <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_fili.r1215 }}</td>
                            <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_fili.r1216 }}</td>
                            <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_fili.r1217 }}</td>
                            <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_fili.r1218 }}</td>
                            <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_fili.r12118 }}</td>
                            <td style="text-align: center" data-col-id="row_total_fili_type_contrat">{{ total_fili_type_contrat }}</td>
                            <td style="text-align: center" data-col-group='row_total_fili_temps'>{{ total_fili.r1219 }}</td>
                            <td style="text-align: center" data-col-group='row_total_fili_temps'>{{ total_fili.r12110 }}</td>
                            <td style="text-align: center" data-col-id='row_total_fili_temps'>{{ total_fili_temps }}</td>
                            <td style="text-align: center" data-col-group='row_total_fili_anci'>{{ total_fili.r12111 }}</td>
                            <td style="text-align: center" data-col-group='row_total_fili_anci'>{{ total_fili.r12112 }}</td>
                            <td style="text-align: center" data-col-group='row_total_fili_anci'>{{ total_fili.r12113 }}</td>
                            <td style="text-align: center" data-col-id='row_total_fili_anci'>{{ total_fili_anci }}</td>
                            <td style="text-align: center" data-col-group='row_total_fili_cdi'>{{ total_fili.r12114 }}</td>
                            <td style="text-align: center" data-col-group='row_total_fili_cdi'>{{ total_fili.r12115 }}</td>
                            <td style="text-align: center" data-col-id='row_total_fili_cdi' data-col-group='row_total_cdi_cdd'>{{ total_fili_cdi }}</td>
                            <td style="text-align: center" data-col-group='row_total_fili_cdd'>{{ total_fili.r12116 }}</td>
                            <td style="text-align: center" data-col-group='row_total_fili_cdd'>{{ total_fili.r12117 }}</td>
                            <td style="text-align: center" data-col-id='row_total_fili_cdd' data-col-group='row_total_cdi_cdd' >{{ total_fili_cdd }}</td>
                            <td style="text-align: center" data-col-id='row_total_cdi_cdd'>{{ total_fili_cdi_cdd }}</td>
                        </tr>
                    {% endif %}
                {% endfor %}

                {# <tr id="totalHorsFil" class="filiTable" style="display: none">
                    <td></td>
                    <td style="text-align: center">{{totalInd121.r1211}}</td>
                    <td style="text-align: center">{{totalInd121.r1212}}</td>
                    <td style="text-align: center">{{totalInd121.r1213}}</td>
                    <td style="text-align: center">{{totalInd121.r1214}}</td>
                    <td style="text-align: center">{{totalInd121.r1215}}</td>
                    <td style="text-align: center">{{totalInd121.r1216}}</td>
                    <td style="text-align: center">{{totalInd121.r1217}}</td>
                    <td style="text-align: center">{{totalInd121.r1218}}</td>
                    <td style="text-align: center">{{totalInd121.r12118}}</td>
                    <td style="text-align: center">0</td>
                    <td style="text-align: center">{{totalInd121.r1219}}</td>
                    <td style="text-align: center">{{totalInd121.r12110}}</td>
                    <td style="text-align: center">{{totalInd121.r12111}}</td>
                    <td style="text-align: center">{{totalInd121.r12112}}</td>
                    <td style="text-align: center">{{totalInd121.r12113}}</td>
                    <td style="text-align: center">{{totalInd121.r12114}}</td>
                    <td style="text-align: center">{{totalInd121.r12115}}</td>
                    <td style="text-align: center">{{totalInd121.r12116}}</td>
                    <td style="text-align: center">{{totalInd121.r12117}}</td>

                </tr> #}
                {% set total_all_fili = bilan_social_consolide.getIndPileForBy('ind121s',['refCadreEmploi','refFiliere','cdFili'],['AOTM','H','HH'],{'exclude':true}) %}
                {% set total_all_fili_type_contrat = total_all_fili.r1211 + total_all_fili.r1212 + total_all_fili.r1213 + total_all_fili.r1214 + total_all_fili.r1215 + total_all_fili.r1216 + total_all_fili.r1217 + total_all_fili.r1218 + total_all_fili.r12118 %}
                {% set total_all_fili_temps = total_all_fili.r1219 + total_all_fili.r12110 %}
                {% set total_all_fili_anci = total_all_fili.r12111 + total_all_fili.r12112 + total_all_fili.r12113 %}
                {% set total_all_fili_cdi = total_all_fili.r12114 + total_all_fili.r12115 %}
                {% set total_all_fili_cdd = total_all_fili.r12116 + total_all_fili.r12117 %}
                {% set total_all_fili_cdi_cdd = total_all_fili.r12114 + total_all_fili.r12115 + total_all_fili.r12116 + total_all_fili.r12117 %}
                <tr class="filiTable row_totaux" id="totalFilGlo">
                    <td><b>TOUTES FILIERES</b></td>
                    <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_all_fili.r1211 }}</td>
                    <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_all_fili.r1212 }}</td>
                    <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_all_fili.r1213 }}</td>
                    <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_all_fili.r1214 }}</td>
                    <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_all_fili.r1215 }}</td>
                    <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_all_fili.r1216 }}</td>
                    <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_all_fili.r1217 }}</td>
                    <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_all_fili.r1218 }}</td>
                    <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_all_fili.r12118 }}</td>
                    <td style="text-align: center" data-col-id="row_total_fili_type_contrat">{{ total_all_fili_type_contrat }}</td>
                    <td style="text-align: center" data-col-group='row_total_fili_temps'>{{ total_all_fili.r1219 }}</td>
                    <td style="text-align: center" data-col-group='row_total_fili_temps'>{{ total_all_fili.r12110 }}</td>
                    <td style="text-align: center" data-col-id='row_total_fili_temps'>{{ total_all_fili_temps }}</td>
                    <td style="text-align: center" data-col-group='row_total_fili_anci'>{{ total_all_fili.r12111 }}</td>
                    <td style="text-align: center" data-col-group='row_total_fili_anci'>{{ total_all_fili.r12112 }}</td>
                    <td style="text-align: center" data-col-group='row_total_fili_anci'>{{ total_all_fili.r12113 }}</td>
                    <td style="text-align: center" data-col-id='row_total_fili_anci'>{{ total_all_fili_anci }}</td>
                    <td style="text-align: center" data-col-group='row_total_fili_cdi'>{{ total_all_fili.r12114 }}</td>
                    <td style="text-align: center" data-col-group='row_total_fili_cdi'>{{ total_all_fili.r12115 }}</td>
                    <td style="text-align: center" data-col-id='row_total_fili_cdi' data-col-group='row_total_cdi_cdd'>{{ total_all_fili_cdi }}</td>
                    <td style="text-align: center" data-col-group='row_total_fili_cdd'>{{ total_all_fili.r12116 }}</td>
                    <td style="text-align: center" data-col-group='row_total_fili_cdd'>{{ total_all_fili.r12117 }}</td>
                    <td style="text-align: center" data-col-id='row_total_fili_cdd' data-col-group='row_total_cdi_cdd'>{{ total_all_fili_cdd }}</td>
                    <td style="text-align: center" data-col-id='row_total_cdi_cdd'>{{ total_all_fili_cdi_cdd }}</td>
                </tr>

                {% for tag in formEffectif121.ind121AotmsTemp %}
                    {% set row_data = tag.vars.value %}
                    {% set total_fili_type_contrat = row_data.r1211 + row_data.r1212 + row_data.r1213 + row_data.r1214 + row_data.r1215 + row_data.r1216 + row_data.r1217 + row_data.r1218 + row_data.r12118 %}
                    {% set total_fili_temps = row_data.r1219 + row_data.r12110 %}
                    {% set total_fili_anci = row_data.r12111 + row_data.r12112 + row_data.r12113 %}
                    {% set total_fili_cdi = row_data.r12114 + row_data.r12115 %}
                    {% set total_fili_cdd = row_data.r12116 + row_data.r12117 %}
                    {% set total_fili_cdi_cdd = row_data.r12114 + row_data.r12115 + row_data.r12116 + row_data.r12117 %}
                    <tr  cdFili="{{ tag.cdFili.vars.value }}"
                         id="121trCE_{{tag.refCadreEmploi.vars.value}}"
                         idTrFiliAotm="{{ tag.idFili.vars.value }}"
                         idCe="{{ tag.refCadreEmploi.vars.value }}"
                         >
                        <td>
                            {{ form_widget(tag.refCadreEmploi) }}
                            {{ form_widget(tag.idFili) }}
                            {{ form_widget(tag.cdFili) }}
                            {{ form_widget(tag.lbFili) }}
                            {{ tag.refCadreEmploi.vars.data.lbCadrempl }}

                        </td>
                        <td id="r1211" style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ form_widget(tag.r1211) }}</td>
                        <td id="r1212" style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ form_widget(tag.r1212) }}</td>
                        <td id="r1213" style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ form_widget(tag.r1213) }}</td>
                        <td id="r1214" style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ form_widget(tag.r1214) }}</td>
                        <td id="r1215" style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ form_widget(tag.r1215) }}</td>
                        <td id="r1216" style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ form_widget(tag.r1216) }}</td>
                        <td id="r1217" style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ form_widget(tag.r1217) }}</td>
                        <td id="r1218" style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ form_widget(tag.r1218) }}</td>
                        <td id="r12118" style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ form_widget(tag.r12118) }}</td>
                        <td class="filiTable" id="lineTot1" style="text-align: center" data-col-id="row_total_fili_type_contrat">{{ total_fili_type_contrat }}</td>
                        <td id="r1219" style="text-align: center" data-col-group='row_total_fili_temps'>{{ form_widget(tag.r1219) }}</td>
                        <td id="r12110" style="text-align: center" data-col-group='row_total_fili_temps'>{{ form_widget(tag.r12110) }}</td>
                        <td style="text-align: center" data-col-id='row_total_fili_temps'>{{ total_fili_temps }}</td>
                        <td id="r12111" style="text-align: center" data-col-group='row_total_fili_anci'>{{ form_widget(tag.r12111) }}</td>
                        <td id="r12112" style="text-align: center" data-col-group='row_total_fili_anci'>{{ form_widget(tag.r12112) }}</td>
                        <td id="r12113" style="text-align: center" data-col-group='row_total_fili_anci'>{{ form_widget(tag.r12113) }}</td>
                        <td style="text-align: center" data-col-id='row_total_fili_anci'>{{ total_fili_anci }}</td>
                        <td id="r12114" style="text-align: center" data-col-group='row_total_fili_cdi'>{{ form_widget(tag.r12114) }}</td>
                        <td id="r12115" style="text-align: center" data-col-group='row_total_fili_cdi'>{{ form_widget(tag.r12115) }}</td>
                        <td style="text-align: center" data-col-id='row_total_fili_cdi' data-col-group='row_total_cdi_cdd'>{{ total_fili_cdi }}</td>
                        <td id="r12116" style="text-align: center" data-col-group='row_total_fili_cdd'>{{ form_widget(tag.r12116) }}</td>
                        <td id="r12117" style="text-align: center" data-col-group='row_total_fili_cdd'>{{ form_widget(tag.r12117) }}</td>
                        <td style="text-align: center" data-col-id='row_total_fili_cdd' data-col-group='row_total_cdi_cdd'>{{ total_fili_cdd }}</td>
                        <td style="text-align: center" data-col-id='row_total_cdi_cdd'>{{ total_fili_cdi_cdd }}</td>

                    </tr>

                    {{ form_widget(tag.newFiliere) }}
                    {{ form_widget(tag.idFili) }}
                    {{ form_widget(tag.cdFili) }}
                    {{ form_widget(tag.lastFiliere) }}

                {% endfor %}
                {% set total_ind = bilan_social_consolide.getIndPileForBy('ind121s',['refCadreEmploi','refFiliere','cdFili'],['H','HH'],{'exclude':true}) %}
                {% set total_ind_type_contrat = total_ind.r1211 + total_ind.r1212 + total_ind.r1213 + total_ind.r1214 + total_ind.r1215 + total_ind.r1216 + total_ind.r1217 + total_ind.r1218 + total_ind.r12118 %}
                {% set total_fili_temps = total_ind.r1219 + total_ind.r12110 %}
                {% set total_fili_anci = total_ind.r12111 + total_ind.r12112 + total_ind.r12113 %}
                {% set total_fili_cdi = total_ind.r12114 + total_ind.r12115 %}
                {% set total_fili_cdd = total_ind.r12116 + total_ind.r12117 %}
                {% set total_fili_cdi_cdd = total_ind.r12114 + total_ind.r12115 + total_ind.r12116 + total_ind.r12117 %}
                <tr class="filiTable row_totaux" id="totalGlo">
                    <td><b>TOTAL</b></td>
                    <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_ind.r1211 }}</td>
                    <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_ind.r1212 }}</td>
                    <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_ind.r1213 }}</td>
                    <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_ind.r1214 }}</td>
                    <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_ind.r1215 }}</td>
                    <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_ind.r1216 }}</td>
                    <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_ind.r1217 }}</td>
                    <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_ind.r1218 }}</td>
                    <td style="text-align: center" data-col-group="row_total_fili_type_contrat">{{ total_ind.r12118 }}</td>
                    <td style="text-align: center" data-col-id="row_total_fili_type_contrat">{{ total_ind_type_contrat }}</td>
                    <td style="text-align: center" data-col-group='row_total_fili_temps'>{{ total_ind.r1219 }}</td>
                    <td style="text-align: center" data-col-group='row_total_fili_temps'>{{ total_ind.r12110 }}</td>
                    <td style="text-align: center" data-col-id='row_total_fili_temps'>{{ total_fili_temps }}</td>
                    <td style="text-align: center" data-col-group='row_total_fili_anci'>{{ total_ind.r12111 }}</td>
                    <td style="text-align: center" data-col-group='row_total_fili_anci'>{{ total_ind.r12112 }}</td>
                    <td style="text-align: center" data-col-group='row_total_fili_anci'>{{ total_ind.r12113 }}</td>
                    <td style="text-align: center" data-col-id='row_total_fili_anci'>{{ total_fili_anci }}</td>
                    <td style="text-align: center" data-col-group='row_total_fili_cdi'>{{ total_ind.r12114 }}</td>
                    <td style="text-align: center" data-col-group='row_total_fili_cdi'>{{ total_ind.r12115 }}</td>
                    <td style="text-align: center" data-col-id='row_total_fili_cdi' data-col-group='row_total_cdi_cdd'>{{ total_fili_cdi }}</td>
                    <td style="text-align: center" data-col-group='row_total_fili_cdd'>{{ total_ind.r12116 }}</td>
                    <td style="text-align: center" data-col-group='row_total_fili_cdd'>{{ total_ind.r12117 }}</td>
                    <td style="text-align: center" data-col-id='row_total_fili_cdd' data-col-group='row_total_cdi_cdd'>{{ total_fili_cdd }}</td>
                    <td style="text-align: center" data-col-id='row_total_cdi_cdd'>{{ total_fili_cdi_cdd }}</td>
                </tr>

            </tbody>
        </table>
        <br/>


        <input class="btn button-tableau pull-right" type="submit" value="Enregistrer et valider les contrôles de cohérence" name="valider" onclick="recordAuto = false;
                $('#progImg').show();" data-valide="1" />

        <img id="progImg" src="{{ asset("img/progress.gif") }}" style="display:none"/>

        {{ form_end(formEffectif121) }}



        <script type="text/javascript">


            $(document).ready(function ()
            {
                changeDetect = false;
                {% include 'stickyheader.txt' %}
                getBrowserSetSticky(ind121Table);

            {% if questionCollectiviteConsolide.q4 == true %}

                    putSelectOnText121('ind121sTemp', 'refCadreEmploi');
                    putSelectOnText121('ind121AotmsTemp', 'refCadreEmploi');
                    $(document).change();
                    //update121(true);

            {% endif %}
                });

                /**
                 * Symfony met les entity many to one en select
                 *       - Impossibilité de mettre en dsabled car à  l'envoi du form, no ne récup plus la valeur du référentiel
                 * => Solution temporaire :
                 *       - Cacher le select de l'entity référentiel
                 *       - récupérer le text sélectionné par défaut du référentiel
                 *       - ajouter ce texte à  la colonne du tab correpondant
                 */
                function putSelectOnText121(listName, referentielName, withCompl, withNoLibelle) {
                    var count = $('#bscForm121_' + listName + '_0_' + referentielName + ' option').length;

                    for (var i = 0; i < count; i++) {
                        $('#bscForm121_' + listName + '_' + i + '_' + referentielName + '').hide();

                        if (withNoLibelle == undefined) {
                            var val = $('#bscForm121_' + listName + '_' + i + '_' + referentielName + ' option:selected').val();
                            var tex = $('#bscForm121_' + listName + '_' + i + '_' + referentielName + ' option:selected').text();
                            //$('#bscForm121_'+listName+'_'+i+'_'+referentielName+'').parent().append(tex);
                        }

                        if (withCompl != undefined) {
                            //$('#bscForm121_'+listName+'_'+i+'_'+referentielName+'').parent().append(' '
                            //   + '<span id="bscForm121_'+listName+'_'+i+'_'+referentielName+'_'+val+'"></span>');
                        }
                    }
                }


                function initLight121() {
                    if (incoherenceList != undefined) {
                        // Si le json js a été chargé  (via un eneregistrement) => light via le json
                        for (var idx in incoherenceList) {
                            var incoh = incoherenceList[idx];
                            if (incoh.tableNum == '1.2.1') {
                                lightError(incoh.field, incoh.incoherence);
                            }
                        }
                    } else {
                        // si premier acces à la page => light via le twig

                        {% for tag in incoherenceList %}
                            {% if tag.tableNum == '1.2.1' %}
                            lightError('{{tag.field}}', {{tag.blIncoherence}});
                            {% endif %}
                        {% endfor %}

                    }
                }

                /*
                 * METHODES Tableau 1.1.2
                 */
            {% if questionCollectiviteConsolide.q4 == true %}

                function toggleFiliere121(toggleObj, pidFili) {
                    var css = toggleObj.getAttribute('class');

                {% if idFili != null and idFili != 0 %}
                        // Sauvegarde auto
                        if (currentTab != "")
                            saveTab(currentTab);
                {% endif %}

                        if (css == "buttonplus") {
                            $('#ind121').load('{{ path('bilan_conso_effectif_ind121_edit') }}?idFili=' + pidFili, function () {
                                initLight121();
                                disabled();
                            });

                        } else {
                            $('#ind121').load('{{ path('bilan_conso_effectif_ind121_edit') }}?idFili=' + 0, function () {
                                initLight121();
                                disabled();
                            });

                        }
                    }

                    function changedR121(obj) {
                        //update121(false);
                    }



                    function update121(onInit) {
                        var table121 = document.getElementById('ind121Table');

                        var rowLength121 = table121.rows.length;
                        var idxRowInput = 0;
                        var idxRowInputAotm = 0;

                        var mtTot1 = 0;
                        var mtTot2 = 0;
                        var mtTot3 = 0;
                        var mtTot4 = 0;
                        var mtTot5 = 0;
                        var mtTot6 = 0;
                        var mtTot7 = 0;
                        var mtTot8 = 0;
                        var mtTot9 = 0;
                        var mtTot10 = 0;
                        var mtTot11 = 0;
                        var mtTot12 = 0;
                        var mtTot13 = 0;
                        var mtTot14 = 0;
                        var mtTot15 = 0;
                        var mtTot16 = 0;
                        var mtTot17 = 0;
                        var mtTot18 = 0;

                        var mtTot1Fil = 0;
                        var mtTot2Fil = 0;
                        var mtTot3Fil = 0;
                        var mtTot4Fil = 0;
                        var mtTot5Fil = 0;
                        var mtTot6Fil = 0;
                        var mtTot7Fil = 0;
                        var mtTot8Fil = 0;
                        var mtTot9Fil = 0;
                        var mtTot10Fil = 0;
                        var mtTot11Fil = 0;
                        var mtTot12Fil = 0;
                        var mtTot13Fil = 0;
                        var mtTot14Fil = 0;
                        var mtTot15Fil = 0;
                        var mtTot16Fil = 0;
                        var mtTot17Fil = 0;
                        var mtTot18Fil = 0;

                        var mtTot1FilGlo = 0;
                        var mtTot2FilGlo = 0;
                        var mtTot3FilGlo = 0;
                        var mtTot4FilGlo = 0;
                        var mtTot5FilGlo = 0;
                        var mtTot6FilGlo = 0;
                        var mtTot7FilGlo = 0;
                        var mtTot8FilGlo = 0;
                        var mtTot9FilGlo = 0;
                        var mtTot10FilGlo = 0;
                        var mtTot11FilGlo = 0;
                        var mtTot12FilGlo = 0;
                        var mtTot13FilGlo = 0;
                        var mtTot14FilGlo = 0;
                        var mtTot15FilGlo = 0;
                        var mtTot16FilGlo = 0;
                        var mtTot17FilGlo = 0;
                        var mtTot18FilGlo = 0;

                        var mtTot1HorsFil = 0;
                        var mtTot2HorsFil = 0;
                        var mtTot3HorsFil = 0;
                        var mtTot4HorsFil = 0;
                        var mtTot5HorsFil = 0;
                        var mtTot6HorsFil = 0;
                        var mtTot7HorsFil = 0;
                        var mtTot8HorsFil = 0;
                        var mtTot9HorsFil = 0;
                        var mtTot10HorsFil = 0;
                        var mtTot11HorsFil = 0;
                        var mtTot12HorsFil = 0;
                        var mtTot13HorsFil = 0;
                        var mtTot14HorsFil = 0;
                        var mtTot15HorsFil = 0;
                        var mtTot16HorsFil = 0;
                        var mtTot17HorsFil = 0;
                        var mtTot18HorsFil = 0;

                        var mtTot1Glo = 0;
                        var mtTot2Glo = 0;
                        var mtTot3Glo = 0;
                        var mtTot4Glo = 0;
                        var mtTot5Glo = 0;
                        var mtTot6Glo = 0;
                        var mtTot7Glo = 0;
                        var mtTot8Glo = 0;
                        var mtTot9Glo = 0;
                        var mtTot10Glo = 0;
                        var mtTot11Glo = 0;
                        var mtTot12Glo = 0;
                        var mtTot13Glo = 0;
                        var mtTot14Glo = 0;
                        var mtTot15Glo = 0;
                        var mtTot16Glo = 0;
                        var mtTot17Glo = 0;
                        var mtTot18Glo = 0;

                        for (var i = 0; i < rowLength121; i += 1) {
                            var row = table121.rows[i];

                            if(row.getAttribute("entete") != undefined && row.getAttribute("entete") == "1") {
                                continue;
                            }

                            var lineAotm = false;

                            if(row.getAttribute("idTrFiliAotm") != undefined) {
                                lineAotm = true;
                            }

                            var cellLength = row.cells.length;

                            var lineTotalFil = false;
                            var lineTotalFilGlo = false;
                            var lineTotalGlo = false;
                            var lineTot1 = 0;

                            if (row.id.substring(0, 8) == "entetFil") {
                                continue;
                            }

                            if (row.id.substring(0, 18) == "totalHorsFil") {
                                for (var y = 0; y < cellLength; y += 1) {
                                    var cell = row.cells[y];
                                    if (y == 1) {
                                        mtTot1HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 2) {
                                        mtTot2HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 3) {
                                        mtTot3HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 4) {
                                        mtTot4HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 5) {
                                        mtTot5HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 6) {
                                        mtTot6HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 7) {
                                        mtTot7HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 8) {
                                        mtTot8HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 9) {
                                        mtTot18HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 11) {
                                        mtTot9HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 12) {
                                        mtTot10HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 13) {
                                        mtTot11HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 14) {
                                        mtTot12HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 15) {
                                        mtTot13HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 16) {
                                        mtTot14HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 17) {
                                        mtTot15HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 18) {
                                        mtTot16HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 19) {
                                        mtTot17HorsFil = parseInt(cell.innerHTML);
                                    }
                                }
                            }

                            lineTot1 = 0;

                            if (row.id.substring(0, 11) == "totalFilGlo") {
                                lineTotalFilGlo = true;

                                for (var y = 0; y < cellLength; y += 1) {
                                    var cell = row.cells[y];
                                    if (y == 1) {
                                        cell.innerHTML = mtTot1FilGlo + mtTot1HorsFil;
                                        lineTot1 += mtTot1FilGlo + mtTot1HorsFil;
                                        mtTot1FilGlo = 0;
                                    } else if (y == 2) {
                                        cell.innerHTML = mtTot2FilGlo + mtTot2HorsFil;
                                        lineTot1 += mtTot2FilGlo + mtTot2HorsFil;
                                        mtTot2FilGlo = 0;
                                    } else if (y == 3) {
                                        cell.innerHTML = mtTot3FilGlo + mtTot3HorsFil;
                                        lineTot1 += mtTot3FilGlo + mtTot3HorsFil;
                                        mtTot3FilGlo = 0;
                                    } else if (y == 4) {
                                        cell.innerHTML = mtTot4FilGlo + mtTot4HorsFil;
                                        lineTot1 += mtTot4FilGlo + mtTot4HorsFil;
                                        mtTot4FilGlo = 0;
                                    } else if (y == 5) {
                                        cell.innerHTML = mtTot5FilGlo + mtTot5HorsFil;
                                        lineTot1 += mtTot5FilGlo + mtTot5HorsFil;
                                        mtTot5FilGlo = 0;
                                    } else if (y == 6) {
                                        cell.innerHTML = mtTot6FilGlo + mtTot6HorsFil;
                                        lineTot1 += mtTot6FilGlo + mtTot6HorsFil;
                                        mtTot6FilGlo = 0;
                                    } else if (y == 7) {
                                        cell.innerHTML = mtTot7FilGlo + mtTot7HorsFil;
                                        lineTot1 += mtTot7FilGlo + mtTot7HorsFil;
                                        mtTot7FilGlo = 0;
                                    } else if (y == 8) {
                                        cell.innerHTML = mtTot8FilGlo + mtTot8HorsFil;
                                        lineTot1 += mtTot8FilGlo + mtTot8HorsFil;
                                        mtTot8FilGlo = 0;
                                    } else if (y == 9) {
                                        cell.innerHTML = mtTot18FilGlo + mtTot18HorsFil;
                                        lineTot1 += mtTot18FilGlo + mtTot18HorsFil;
                                        mtTot18FilGlo = 0;
                                    } else if (y == 10) {
                                        cell.innerHTML = lineTot1;
                                    } else if (y == 11) {
                                        cell.innerHTML = mtTot9FilGlo + mtTot9HorsFil;
                                        mtTot9FilGlo = 0;
                                    } else if (y == 12) {
                                        cell.innerHTML = mtTot10FilGlo + mtTot10HorsFil;
                                        mtTot10FilGlo = 0;
                                    } else if (y == 13) {
                                        cell.innerHTML = mtTot11FilGlo + mtTot11HorsFil;
                                        mtTot11FilGlo = 0;
                                    } else if (y == 14) {
                                        cell.innerHTML = mtTot12FilGlo + mtTot12HorsFil;
                                        mtTot12FilGlo = 0;
                                    } else if (y == 15) {
                                        cell.innerHTML = mtTot13FilGlo + mtTot13HorsFil;
                                        mtTot13FilGlo = 0;
                                    } else if (y == 16) {
                                        cell.innerHTML = mtTot14FilGlo + mtTot14HorsFil;
                                        mtTot14FilGlo = 0;
                                    } else if (y == 17) {
                                        cell.innerHTML = mtTot15FilGlo + mtTot15HorsFil;
                                        mtTot15FilGlo = 0;
                                    } else if (y == 18) {
                                        cell.innerHTML = mtTot16FilGlo + mtTot16HorsFil;
                                        mtTot16FilGlo = 0;
                                    } else if (y == 19) {
                                        cell.innerHTML = mtTot17FilGlo + mtTot17HorsFil;
                                        mtTot17FilGlo = 0;
                                    }
                                }
                            } else if (row.id.substring(0, 8) == "totalFil") {
                                lineTotalFil = true;

                                //var cdFiliEnt = row.getAttribute("cdFili");

                                for (var y = 0; y < cellLength; y += 1) {
                                    var cell = row.cells[y];
                                    if (y == 1) {
                                        cell.innerHTML = mtTot1Fil;
                                        lineTot1 += mtTot1Fil;
                                        mtTot1Fil = 0;
                                    } else if (y == 2) {
                                        cell.innerHTML = mtTot2Fil;
                                        lineTot1 += mtTot2Fil;
                                        mtTot2Fil = 0;
                                    } else if (y == 3) {
                                        cell.innerHTML = mtTot3Fil;
                                        lineTot1 += mtTot3Fil;
                                        mtTot3Fil = 0;
                                    } else if (y == 4) {
                                        cell.innerHTML = mtTot4Fil;
                                        lineTot1 += mtTot4Fil;
                                        mtTot4Fil = 0;
                                    } else if (y == 5) {
                                        cell.innerHTML = mtTot5Fil;
                                        lineTot1 += mtTot5Fil;
                                        mtTot5Fil = 0;
                                    } else if (y == 6) {
                                        cell.innerHTML = mtTot6Fil;
                                        lineTot1 += mtTot6Fil;
                                        mtTot6Fil = 0;
                                    } else if (y == 7) {
                                        cell.innerHTML = mtTot7Fil;
                                        lineTot1 += mtTot7Fil;
                                        mtTot7Fil = 0;
                                    } else if (y == 8) {
                                        cell.innerHTML = mtTot8Fil;
                                        lineTot1 += mtTot8Fil;
                                        mtTot8Fil = 0;
                                    } else if (y == 9) {
                                        cell.innerHTML = mtTot18Fil;
                                        lineTot1 += mtTot18Fil;
                                        mtTot18Fil = 0;
                                    } else if (y == 10) {
                                        cell.innerHTML = lineTot1;
                                    } else if (y == 11) {
                                        cell.innerHTML = mtTot9Fil;
                                        mtTot9Fil = 0;
                                    } else if (y == 12) {
                                        cell.innerHTML = mtTot10Fil;
                                        mtTot10Fil = 0;
                                    } else if (y == 13) {
                                        cell.innerHTML = mtTot11Fil;
                                        mtTot11Fil = 0;
                                    } else if (y == 14) {
                                        cell.innerHTML = mtTot12Fil;
                                        mtTot12Fil = 0;
                                    } else if (y == 15) {
                                        cell.innerHTML = mtTot13Fil;
                                        mtTot13Fil = 0;
                                    } else if (y == 16) {
                                        cell.innerHTML = mtTot14Fil;
                                        mtTot14Fil = 0;
                                    } else if (y == 17) {
                                        cell.innerHTML = mtTot15Fil;
                                        mtTot15Fil = 0;
                                    } else if (y == 18) {
                                        cell.innerHTML = mtTot16Fil;
                                        mtTot16Fil = 0;
                                    } else if (y == 19) {
                                        cell.innerHTML = mtTot17Fil;
                                        mtTot17Fil = 0;
                                    }

                                }
                            }

                            lineTot1 = 0;

                            if (row.id.substring(0, 8) == "totalGlo") {
                                lineTotalGlo = true;

                                for (var y = 0; y < cellLength; y += 1) {
                                    var cell = row.cells[y];
                                    if (y == 1) {
                                        cell.innerHTML = mtTot1Glo + mtTot1HorsFil;
                                        lineTot1 += mtTot1Glo + mtTot1HorsFil;
                                        mtTot1Glo = 0;
                                    } else if (y == 2) {
                                        cell.innerHTML = mtTot2Glo + mtTot2HorsFil;
                                        lineTot1 += mtTot2Glo + mtTot2HorsFil;
                                        mtTot2Glo = 0;
                                    } else if (y == 3) {
                                        cell.innerHTML = mtTot3Glo + mtTot3HorsFil;
                                        lineTot1 += mtTot3Glo + mtTot3HorsFil;
                                        mtTot3Glo = 0;
                                    } else if (y == 4) {
                                        cell.innerHTML = mtTot4Glo + mtTot4HorsFil;
                                        lineTot1 += mtTot4Glo + mtTot4HorsFil;
                                        mtTot4Glo = 0;
                                    } else if (y == 5) {
                                        cell.innerHTML = mtTot5Glo + mtTot5HorsFil;
                                        lineTot1 += mtTot5Glo + mtTot5HorsFil;
                                        mtTot5Glo = 0;
                                    } else if (y == 6) {
                                        cell.innerHTML = mtTot6Glo + mtTot6HorsFil;
                                        lineTot1 += mtTot6Glo + mtTot6HorsFil;
                                        mtTot6Glo = 0;
                                    } else if (y == 7) {
                                        cell.innerHTML = mtTot7Glo + mtTot7HorsFil;
                                        lineTot1 += mtTot7Glo + mtTot7HorsFil;
                                        mtTot7Glo = 0;
                                    } else if (y == 8) {
                                        cell.innerHTML = mtTot8Glo + mtTot8HorsFil;
                                        lineTot1 += mtTot8Glo + mtTot8HorsFil;
                                        mtTot8Glo = 0;
                                    } else if (y == 9) {
                                        cell.innerHTML = mtTot18Glo + mtTot18HorsFil;
                                        lineTot1 += mtTot18Glo + mtTot18HorsFil;
                                        mtTot18Glo = 0;
                                    } else if (y == 10) {
                                        cell.innerHTML = lineTot1;
                                    } else if (y == 11) {
                                        cell.innerHTML = mtTot9Glo + mtTot9HorsFil;
                                        mtTot9Glo = 0;
                                    } else if (y == 12) {
                                        cell.innerHTML = mtTot10Glo + mtTot10HorsFil;
                                        mtTot10Glo = 0;
                                    } else if (y == 13) {
                                        cell.innerHTML = mtTot11Glo + mtTot11HorsFil;
                                        mtTot11Glo = 0;
                                    } else if (y == 14) {
                                        cell.innerHTML = mtTot12Glo + mtTot12HorsFil;
                                        mtTot12Glo = 0;
                                    } else if (y == 15) {
                                        cell.innerHTML = mtTot13Glo + mtTot13HorsFil;
                                        mtTot13Glo = 0;
                                    } else if (y == 16) {
                                        cell.innerHTML = mtTot14Glo + mtTot14HorsFil;
                                        mtTot14Glo = 0;
                                    } else if (y == 17) {
                                        cell.innerHTML = mtTot15Glo + mtTot15HorsFil;
                                        mtTot15Glo = 0;
                                    } else if (y == 18) {
                                        cell.innerHTML = mtTot16Glo + mtTot16HorsFil;
                                        mtTot16Glo = 0;
                                    } else if (y == 19) {
                                        cell.innerHTML = mtTot17Glo + mtTot17HorsFil;
                                        mtTot17Glo = 0;
                                    }
                                }
                            }

                            lineTot1 = 0;

                            //var cdFili = row.getAttribute("cdFili");

                            for (var y = 0; y < cellLength; y += 1) {
                                var cell = row.cells[y];
                                var cellValue;

                                if (cell.id.substring(0, 5) == "r1212") {
                                    cellValue = $('#bscForm121_ind121' + (lineAotm ? 'Aotm' : '') + 'sTemp_' + (lineAotm ? idxRowInputAotm : idxRowInput) + '_r1212').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);
                                        if(!lineAotm) {
                                            mtTot2 += cellValue;
                                            mtTot2Fil += cellValue;
                                            mtTot2FilGlo += cellValue;
                                        }
                                        mtTot2Glo += cellValue;
                                        lineTot1 += cellValue;
                                    }
                                    //if ($('#bscForm121_ind121sTemp_' + idxRowInput + '_r1212').val() != "") {
                                    //    mtTot2 += parseInt($('#bscForm121_ind121sTemp_' + idxRowInput + '_r1212').val());
                                    //    mtTot2Fil += parseInt($('#bscForm121_ind121sTemp_' + idxRowInput + '_r1212').val());
                                    //    mtTot2FilGlo += parseInt($('#bscForm121_ind121sTemp_' + idxRowInput + '_r1212').val());
                                    //    lineTot1 += parseInt($('#bscForm121_ind121sTemp_' + idxRowInput + '_r1212').val());
                                    //}
                                } else if (cell.id.substring(0, 5) == "r1213") {
                                    cellValue = $('#bscForm121_ind121' + (lineAotm ? 'Aotm' : '') + 'sTemp_' + (lineAotm ? idxRowInputAotm : idxRowInput) + '_r1213').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);
                                        if(!lineAotm) {
                                            mtTot3 += cellValue;
                                            mtTot3Fil += cellValue;
                                            mtTot3FilGlo += cellValue;
                                        }
                                        mtTot3Glo += cellValue;
                                        lineTot1 += cellValue;
                                    }
                                } else if (cell.id.substring(0, 5) == "r1214") {
                                    cellValue = $('#bscForm121_ind121' + (lineAotm ? 'Aotm' : '') + 'sTemp_' + (lineAotm ? idxRowInputAotm : idxRowInput) + '_r1214').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);
                                        if(!lineAotm) {
                                            mtTot4 += cellValue;
                                            mtTot4Fil += cellValue;
                                            mtTot4FilGlo += cellValue;
                                        }
                                        mtTot4Glo += cellValue;
                                        lineTot1 += cellValue;
                                    }
                                } else if (cell.id.substring(0, 5) == "r1215") {
                                    cellValue = $('#bscForm121_ind121' + (lineAotm ? 'Aotm' : '') + 'sTemp_' + (lineAotm ? idxRowInputAotm : idxRowInput) + '_r1215').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);
                                        if(!lineAotm) {
                                            mtTot5 += cellValue;
                                            mtTot5Fil += cellValue;
                                            mtTot5FilGlo += cellValue;
                                        }
                                        mtTot5Glo += cellValue;
                                        lineTot1 += cellValue;
                                    }
                                } else if (cell.id.substring(0, 5) == "r1216") {
                                    cellValue = $('#bscForm121_ind121' + (lineAotm ? 'Aotm' : '') + 'sTemp_' + (lineAotm ? idxRowInputAotm : idxRowInput) + '_r1216').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);
                                        if(!lineAotm) {
                                            mtTot6 += cellValue;
                                            mtTot6Fil += cellValue;
                                            mtTot6FilGlo += cellValue;
                                        }
                                        mtTot6Glo += cellValue;
                                        lineTot1 += cellValue;
                                    }
                                } else if (cell.id.substring(0, 5) == "r1217") {
                                    cellValue = $('#bscForm121_ind121' + (lineAotm ? 'Aotm' : '') + 'sTemp_' + (lineAotm ? idxRowInputAotm : idxRowInput) + '_r1217').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);
                                        if(!lineAotm) {
                                            mtTot7 += cellValue;
                                            mtTot7Fil += cellValue;
                                            mtTot7FilGlo += cellValue;
                                        }
                                        mtTot7Glo += cellValue;
                                        lineTot1 += cellValue;
                                    }
                                } else if (cell.id.substring(0, 5) == "r1218") {
                                    cellValue = $('#bscForm121_ind121' + (lineAotm ? 'Aotm' : '') + 'sTemp_' + (lineAotm ? idxRowInputAotm : idxRowInput) + '_r1218').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);
                                        if(!lineAotm) {
                                            mtTot8 += cellValue;
                                            mtTot8Fil += cellValue;
                                            mtTot8FilGlo += cellValue;
                                        }
                                        mtTot8Glo += cellValue;
                                        lineTot1 += cellValue;
                                    }
                                } else if (cell.id.substring(0, 6) == "r12118") {
                                    cellValue = $('#bscForm121_ind121' + (lineAotm ? 'Aotm' : '') + 'sTemp_' + (lineAotm ? idxRowInputAotm : idxRowInput) + '_r12118').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);
                                        if(!lineAotm) {
                                            mtTot18 += cellValue;
                                            mtTot18Fil += cellValue;
                                            mtTot18FilGlo += cellValue;
                                        }
                                        mtTot18Glo += cellValue;
                                        lineTot1 += cellValue;
                                    }
                                } else if (cell.id.substring(0, 8) == "lineTot1") {
                                    cell.innerHTML = lineTot1;
                                } else if (cell.id.substring(0, 5) == "r1219") {
                                    cellValue = $('#bscForm121_ind121' + (lineAotm ? 'Aotm' : '') + 'sTemp_' + (lineAotm ? idxRowInputAotm : idxRowInput) + '_r1219').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);
                                        if(!lineAotm) {
                                            mtTot9 += cellValue;
                                            mtTot9Fil += cellValue;
                                            mtTot9FilGlo += cellValue;
                                        }
                                        mtTot9Glo += cellValue;
                                    }
                                } else if (cell.id.substring(0, 6) == "r12110") {
                                    cellValue = $('#bscForm121_ind121' + (lineAotm ? 'Aotm' : '') + 'sTemp_' + (lineAotm ? idxRowInputAotm : idxRowInput) + '_r12110').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);
                                        if(!lineAotm) {
                                            mtTot10 += cellValue;
                                            mtTot10Fil += cellValue;
                                            mtTot10FilGlo += cellValue;
                                        }
                                        mtTot10Glo += cellValue;
                                    }
                                } else if (cell.id.substring(0, 6) == "r12111") {
                                    cellValue = $('#bscForm121_ind121' + (lineAotm ? 'Aotm' : '') + 'sTemp_' + (lineAotm ? idxRowInputAotm : idxRowInput) + '_r12111').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);
                                        if(!lineAotm) {
                                            mtTot11 += cellValue;
                                            mtTot11Fil += cellValue;
                                            mtTot11FilGlo += cellValue;
                                        }
                                        mtTot11Glo += cellValue;
                                    }
                                } else if (cell.id.substring(0, 6) == "r12112") {
                                    cellValue = $('#bscForm121_ind121' + (lineAotm ? 'Aotm' : '') + 'sTemp_' + (lineAotm ? idxRowInputAotm : idxRowInput) + '_r12112').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);
                                        if(!lineAotm) {
                                            mtTot12 += cellValue;
                                            mtTot12Fil += cellValue;
                                            mtTot12FilGlo += cellValue;
                                        }
                                        mtTot12Glo += cellValue;
                                    }
                                } else if (cell.id.substring(0, 6) == "r12113") {
                                    cellValue = $('#bscForm121_ind121' + (lineAotm ? 'Aotm' : '') + 'sTemp_' + (lineAotm ? idxRowInputAotm : idxRowInput) + '_r12113').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);
                                        if(!lineAotm) {
                                            mtTot13 += cellValue;
                                            mtTot13Fil += cellValue;
                                            mtTot13FilGlo += cellValue;
                                        }
                                        mtTot13Glo += cellValue;
                                    }
                                } else if (cell.id.substring(0, 6) == "r12114") {
                                    cellValue = $('#bscForm121_ind121' + (lineAotm ? 'Aotm' : '') + 'sTemp_' + (lineAotm ? idxRowInputAotm : idxRowInput) + '_r12114').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);
                                        if(!lineAotm) {
                                            mtTot14 += cellValue;
                                            mtTot14Fil += cellValue;
                                            mtTot14FilGlo += cellValue;
                                        }
                                        mtTot14Glo += cellValue;
                                    }
                                } else if (cell.id.substring(0, 6) == "r12115") {
                                    cellValue = $('#bscForm121_ind121' + (lineAotm ? 'Aotm' : '') + 'sTemp_' + (lineAotm ? idxRowInputAotm : idxRowInput) + '_r12115').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);
                                        if(!lineAotm) {
                                            mtTot15 += cellValue;
                                            mtTot15Fil += cellValue;
                                            mtTot15FilGlo += cellValue;
                                        }
                                        mtTot15Glo += cellValue;
                                    }
                                } else if (cell.id.substring(0, 6) == "r12116") {
                                    cellValue = $('#bscForm121_ind121' + (lineAotm ? 'Aotm' : '') + 'sTemp_' + (lineAotm ? idxRowInputAotm : idxRowInput) + '_r12116').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);
                                        if(!lineAotm) {
                                            mtTot16 += cellValue;
                                            mtTot16Fil += cellValue;
                                            mtTot16FilGlo += cellValue;
                                        }
                                        mtTot16Glo += cellValue;
                                    }
                                } else if (cell.id.substring(0, 6) == "r12117") {
                                    cellValue = $('#bscForm121_ind121' + (lineAotm ? 'Aotm' : '') + 'sTemp_' + (lineAotm ? idxRowInputAotm : idxRowInput) + '_r12117').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);
                                        if(!lineAotm) {
                                            mtTot17 += cellValue;
                                            mtTot17Fil += cellValue;
                                            mtTot17FilGlo += cellValue;
                                        }
                                        mtTot17Glo += cellValue;
                                    }
                                } else if (cell.id.substring(0, 5) == "r1211") {
                                    cellValue = $('#bscForm121_ind121' + (lineAotm ? 'Aotm' : '') + 'sTemp_' + (lineAotm ? idxRowInputAotm : idxRowInput) + '_r1211').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);
                                        if(!lineAotm) {
                                            mtTot1 += cellValue;
                                            mtTot1Fil += cellValue;
                                            mtTot1FilGlo += cellValue;
                                        }
                                        mtTot1Glo += cellValue;
                                        lineTot1 += cellValue;
                                    }
                                }
                            }

                            if (!lineTotalFil && !lineTotalFilGlo && !lineTotalGlo) idxRowInput++;
                            if (lineAotm) idxRowInputAotm++;

                        }// end for line

                    }

            {% endif %}


                /*
                 * METHODE AJAX SUBMIT
                 */
                $(function () {
                    // Enregistrement en ajax
                    $('form').on('submit', function (e) {
                        var $this = $(this).closest('div');
                        var btn = $(this).find("input[type=submit]:focus");
                        var value_valide = $(btn).data('valide');
                        $('#bscForm121_valide').val(value_valide);
                        // Submit en ajax pour le fonctionnement d'appel par onglet
                        e.preventDefault();

                        $.ajax({
                            type: 'post',
                            url: '{{ path('bilan_conso_effectif_ind121_edit') }}?idFili={{idFili}}',
                            data: $('form').serialize(),
                            success: function (responsejson) {
                                if (responsejson.data == 1) {
                                    if (recordAuto) {
                                        $('#progImg').hide();
                                        $('#messageJS').html("Enregistrement automatique réussi");

                                        messageJS.dialog("open");
                                        setIncoherenceTable(responsejson);


                                    } else {
                                        $('#ind121').load('{{ path('bilan_conso_effectif_ind121_edit') }}', function () {
                                            $('#progImg').hide();
                                            $('#messageJS').html("Enregistrement réussi");

                                            messageJS.dialog("open");
                                            setIncoherenceTable(responsejson);

                                            var next = $($this).next('.panel-heading');
                                            if(next.length == 0) {
                                                window.location.href = '{{ path('bilan_conso_mouv_edit') }}';
                                            }
                                        });

                                    }
                                } else if (responsejson.data == "-3") {
                                    $('#progImg').hide();
                                    $('#messageJS').html("{{'erreur.unique.violation'|trans}}");
                                    messageJS.dialog("open");
                                } else {
                                    $('#progImg').hide();
                                    $('#messageJS').html("Une erreur s'est produite dans l'enregistrement 1");
                                    messageJS.dialog("open");

                                }


                            },
                            error: function (xhr, status, error) {
                                //alert(xhr);
                                $('#progImg').hide();
                                $('#messageJS').html("Une erreur s'est produite dans l'enregistrement 2 ");
                                messageJS.dialog("open");

                            }

                        });

                    });

                });

        </script>
    {% endif %}
