    {% set campagne = campagne_service.GetCurrentCampagne() %}
    {% set AnneeCamp = '' %}
    {% if campagne is not null %}
        {% set AnneeCamp = campagne.nmAnne %}
    {% endif %}

    {% if formEffectif151 is defined %}
        {% set bilan_social_consolide = formEffectif151.vars.data %}
        {{ form_start(formEffectif151) }}

        <h5>
            Champ : les tableaux qui suivent concernent les agents titulaires et contractuels occupant un emploi permanent
        </h5>

        <table width="100%" id="ind1511Table" class="table table-striped table-hover table-bordered">
            <thead>
                <tr>
                    <th class="th-tableau-ind" rowspan="3">Arrivées en {{AnneeCamp}}</th>
                    <th colspan="16" style="text-align: center">Fonctionnaires de la fonction publique territoriale</th>
                </tr>
                <tr>
                    <th colspan="3" style="text-align: center">Administrateurs</th>
                    <th colspan="3" style="text-align: center">Attachés</th>
                    <th colspan="3" style="text-align: center">Ingénieurs en chef</th>
                    <th colspan="3" style="text-align: center">Ingénieurs</th>
                    <th colspan="3" style="text-align: center">Autres</th>
                    <th class="filiTable" rowspan="2" style="text-align: center">Total</th>
                </tr>
                <tr>
                    <th style="text-align: center">Hommes</th>
                    <th style="text-align: center">Femmes</th>
                    <th class="filiTable" style="text-align: center">Total</th>
                    <th style="text-align: center">Hommes</th>
                    <th style="text-align: center">Femmes</th>
                    <th class="filiTable" style="text-align: center">Total</th>
                    <th style="text-align: center">Hommes</th>
                    <th style="text-align: center">Femmes</th>
                    <th class="filiTable" style="text-align: center">Total</th>
                    <th style="text-align: center">Hommes</th>
                    <th style="text-align: center">Femmes</th>
                    <th class="filiTable" style="text-align: center">Total</th>
                    <th style="text-align: center">Hommes</th>
                    <th style="text-align: center">Femmes</th>
                    <th class="filiTable" style="text-align: center">Total</th>

                </tr>
            </thead>
            <tbody class="ind_table_totaux">
                {% for tag in formEffectif151.ind1511s %}
                    {% set row_data = tag.vars.value %}
                    {% set total_row_admin = row_data.r15111 + row_data.r15112 %}
                    {% set total_row_attache = row_data.r15113 + row_data.r15114 %}
                    {% set total_row_ingenieur_en_chef = row_data.r15115 + row_data.r15116 %}
                    {% set total_row_ingenieur = row_data.r15117 + row_data.r15118 %}
                    {% set total_row_autres = row_data.r15119 + row_data.r151110 %}
                    {% set total_row = total_row_admin + total_row_attache + total_row_ingenieur_en_chef + total_row_autres %}
                    <tr>
                        <td style="min-width: 400px">{{ form_widget(tag.refEmploiFonctionnel) }}
                            {{ tag.refEmploiFonctionnel.vars.data.lbEmplfonc }}
                        </td>
                        <td id="r15111" style="text-align: center" data-col-group='row_total_admin'>{{ form_widget(tag.r15111) }}</td>
                        <td id="r15112" style="text-align: center" data-col-group='row_total_admin'>{{ form_widget(tag.r15112) }}</td>
                        <td class="filiTable" style="text-align: center" data-col-id='row_total_admin' data-col-group='row_total'>{{ total_row_admin }}</td>
                        <td id="r15113" style="text-align: center"  data-col-group='total_row_attache'>{{ form_widget(tag.r15113) }}</td>
                        <td id="r15114" style="text-align: center" data-col-group='total_row_attache'>{{ form_widget(tag.r15114) }}</td>
                        <td class="filiTable" style="text-align: center" data-col-id='total_row_attache' data-col-group='row_total'>{{ total_row_attache }}</td>
                        <td id="r15115" style="text-align: center" data-col-group='total_row_ingenieur_en_chef'>{{ form_widget(tag.r15115) }}</td>
                        <td id="r15116" style="text-align: center" data-col-group='total_row_ingenieur_en_chef'>{{ form_widget(tag.r15116) }}</td>
                        <td class="filiTable" style="text-align: center" data-col-id='total_row_ingenieur_en_chef' data-col-group='row_total'>{{ total_row_ingenieur_en_chef }}</td>
                        <td id="r15117" style="text-align: center" data-col-group='total_row_ingenieur'>{{ form_widget(tag.r15117) }}</td>
                        <td id="r15118" style="text-align: center" data-col-group='total_row_ingenieur'>{{ form_widget(tag.r15118) }}</td>
                        <td class="filiTable" style="text-align: center" data-col-id='total_row_ingenieur' data-col-group='row_total'>{{ total_row_ingenieur }}</td>
                        <td id="r15119" style="text-align: center" data-col-group='total_row_autres'>{{ form_widget(tag.r15119) }}</td>
                        <td id="r151110" style="text-align: center" data-col-group='total_row_autres'>{{ form_widget(tag.r151110) }}</td>
                        <td class="filiTable" style="text-align: center" data-col-id='total_row_autres' data-col-group='row_total'>{{ total_row_autres }}</td>
                        <td class="filiTable" style="text-align: center" data-col-id='row_total'>{{ total_row }}</td>
                    </tr>
                {% endfor %}

                {% if formEffectif151.ind1511s.count() > 0  %}
                    {% set total_ind = bilan_social_consolide.getIndPileForBy('ind1511s') %}
                    {% set total_admin = total_ind.r15111 + total_ind.r15112 %}
                    {% set total_attache = total_ind.r15113 + total_ind.r15114 %}
                    {% set total_ingenieur_en_chef = total_ind.r15115 + total_ind.r15116 %}
                    {% set total_ingenieur = total_ind.r15117 + total_ind.r15118 %}
                    {% set total_autres = total_ind.r15119 + total_ind.r151110 %}
                    {% set total_tot  = total_admin + total_attache + total_ingenieur_en_chef + total_autres %}
                    <tr id="total1511" class="filiTable row_totaux">
                        <td class="filiTable" style="min-width: 400px"><b>TOTAL EMPLOIS FONCTIONNELS</b></td>
                        <td class="filiTable" style="text-align: center" data-col-group='row_total_admin'>{{ total_ind.r15111 }}</td>
                        <td class="filiTable" style="text-align: center" data-col-group='row_total_admin'>{{ total_ind.r15112 }}</td>
                        <td class="filiTable" style="text-align: center" data-col-id='row_total_admin' data-col-group='row_total'>{{ total_admin }}</td>
                        <td class="filiTable" style="text-align: center" data-col-group='total_row_attache'>{{ total_ind.r15113 }}</td>
                        <td class="filiTable" style="text-align: center" data-col-group='total_row_attache'>{{ total_ind.r15114 }}</td>
                        <td class="filiTable" style="text-align: center" data-col-id='total_row_attache' data-col-group='row_total'>{{total_attache}}</td>
                        <td class="filiTable" style="text-align: center" data-col-group='total_row_ingenieur_en_chef'>{{total_ind.r15115}}</td>
                        <td class="filiTable" style="text-align: center" data-col-group='total_row_ingenieur_en_chef'>{{ total_ind.r15116 }}</td>
                        <td class="filiTable" style="text-align: center" data-col-id='total_row_ingenieur_en_chef' data-col-group='row_total'>{{total_ingenieur_en_chef}}</td>
                        <td class="filiTable" style="text-align: center" data-col-group='total_row_ingenieur'>{{total_ind.r15117}}</td>
                        <td class="filiTable" style="text-align: center" data-col-group='total_row_ingenieur'>{{total_ind.r15118}}</td>
                        <td class="filiTable" style="text-align: center" data-col-id='total_row_ingenieur' data-col-group='row_total'>{{total_ingenieur}}</td>
                        <td class="filiTable" style="text-align: center" data-col-group='total_row_autres'>{{total_ind.r15119}}</td>
                        <td class="filiTable" style="text-align: center" data-col-group='total_row_autres'>{{ total_ind.r151110 }}</td>
                        <td class="filiTable" style="text-align: center" data-col-id='total_row_autres' data-col-group='row_total'>{{ total_autres }}</td>
                        <td class="filiTable" style="text-align: center" data-col-id='row_total'>{{ total_tot }}</td>
                    </tr>
                {% endif %}
            </tbody>
        </table>

        <br/>

        <table width="100%"  id="ind1512Table" class="table table-striped table-hover table-bordered">
            <thead>
                <tr>
                    <th class="th-tableau-ind" rowspan="3" >Arrivées en {{AnneeCamp}}</th>
                    <th colspan="16" style="text-align: center">Fonctionnaires issus d'une autre administration (FPE, FPH)</th>
                </tr>
                <tr>
                    <th colspan="3" style="text-align: center">Administrateurs</th>
                    <th colspan="3" style="text-align: center">Attachés</th>
                    <th colspan="3" style="text-align: center">Ingénieurs en chef</th>
                    <th colspan="3" style="text-align: center">Ingénieurs</th>
                    <th colspan="3" style="text-align: center">Autres</th>
                    <th class="filiTable" rowspan="2" style="text-align: center">Total</th>
                </tr>
                <tr>
                    <th style="text-align: center">Hommes</th>
                    <th style="text-align: center">Femmes</th>
                    <th class="filiTable"  style="text-align: center">Total</th>
                    <th style="text-align: center">Hommes</th>
                    <th style="text-align: center">Femmes</th>
                    <th class="filiTable"  style="text-align: center">Total</th>
                    <th style="text-align: center">Hommes</th>
                    <th style="text-align: center">Femmes</th>
                    <th class="filiTable"  style="text-align: center">Total</th>
                    <th style="text-align: center">Hommes</th>
                    <th style="text-align: center">Femmes</th>
                    <th class="filiTable"  style="text-align: center">Total</th>
                    <th style="text-align: center">Hommes</th>
                    <th style="text-align: center">Femmes</th>
                    <th class="filiTable"  style="text-align: center">Total</th>
                </tr>
            </thead>
            <tbody class="ind_table_totaux">
                {% for tag in formEffectif151.ind1512s %}
                    {% set row_data = tag.vars.value %}
                    {% set total_row_admin = row_data.r15121 + row_data.r15122 %}
                    {% set total_row_attache = row_data.r15123 + row_data.r15124 %}
                    {% set total_row_ingenieur_en_chef = row_data.r15125 + row_data.r15126 %}
                    {% set total_row_ingenieur = row_data.r15127 + row_data.r15128 %}
                    {% set total_row_autres = row_data.r15129 + row_data.r151210 %}
                    {% set total_row = total_row_admin + total_row_attache + total_row_ingenieur_en_chef + total_row_autres %}
                    <tr>
                        <td style="min-width: 400px">{{ form_widget(tag.refEmploiFonctionnel) }}
                            {{ tag.refEmploiFonctionnel.vars.data.lbEmplfonc }}
                        </td>
                        <td id="r15121" style="text-align: center" data-col-group='row_total_admin'>{{ form_widget(tag.r15121) }}</td>
                        <td id="r15122" style="text-align: center" data-col-group='row_total_admin'>{{ form_widget(tag.r15122) }}</td>
                        <td class="filiTable" style="text-align: center" data-col-id='row_total_admin' data-col-group='row_total'>{{ total_row_admin }}</td>
                        <td id="r15123" style="text-align: center"  data-col-group='total_row_attache'>{{ form_widget(tag.r15123) }}</td>
                        <td id="r15124" style="text-align: center" data-col-group='total_row_attache'>{{ form_widget(tag.r15124) }}</td>
                        <td class="filiTable" style="text-align: center" data-col-id='total_row_attache' data-col-group='row_total'>{{ total_row_attache }}</td>
                        <td id="r15125" style="text-align: center" data-col-group='total_row_ingenieur_en_chef'>{{ form_widget(tag.r15125) }}</td>
                        <td id="r15126" style="text-align: center" data-col-group='total_row_ingenieur_en_chef'>{{ form_widget(tag.r15126) }}</td>
                        <td class="filiTable" style="text-align: center" data-col-id='total_row_ingenieur_en_chef' data-col-group='row_total'>{{ total_row_ingenieur_en_chef }}</td>
                        <td id="r15127" style="text-align: center" data-col-group='total_row_ingenieur'>{{ form_widget(tag.r15127) }}</td>
                        <td id="r15128" style="text-align: center" data-col-group='total_row_ingenieur'>{{ form_widget(tag.r15128) }}</td>
                        <td class="filiTable" style="text-align: center" data-col-id='total_row_ingenieur' data-col-group='row_total'>{{ total_row_ingenieur }}</td>
                        <td id="r15129" style="text-align: center" data-col-group='total_row_autres'>{{ form_widget(tag.r15129) }}</td>
                        <td id="r151210" style="text-align: center" data-col-group='total_row_autres'>{{ form_widget(tag.r151210) }}</td>
                        <td class="filiTable" style="text-align: center" data-col-id='total_row_autres' data-col-group='row_total'>{{ total_row_autres }}</td>
                        <td class="filiTable" style="text-align: center" data-col-id='row_total'>{{ total_row }}</td>
                    </tr>
                {% endfor %}
                {% if formEffectif151.ind1512s.count() > 0  %}
                    {% set total_ind = bilan_social_consolide.getIndPileForBy('ind1512s') %}
                                        {% set total_ind_admin = total_ind.r15121 + total_ind.r15122 %}
                                        {% set total_ind_attache = total_ind.r15123 + total_ind.r15124 %}
                                        {% set total_ind_ingenieur_en_chef = total_ind.r15125 + total_ind.r15126 %}
                                        {% set total_ind_ingenieur = total_ind.r15127 + total_ind.r15128 %}
                                        {% set total_ind_autres = total_ind.r15129 + total_ind.r151210 %}
                                        {% set total_all = total_ind_admin + total_ind_attache + total_ind_ingenieur_en_chef + total_ind_autres %}
                    <tr id="total1512" class="filiTable row_totaux">
                                                <td class="filiTable" style="min-width: 400px"><b>TOTAL EMPLOIS FONCTIONNELS</b></td>
                                                <td class="filiTable" style="text-align: center" data-col-group='row_total_admin'>{{ total_ind.r15121 }}</td>
                                                <td class="filiTable" style="text-align: center" data-col-group='row_total_admin'>{{ total_ind.r15122 }}</td>
                                                <td class="filiTable" style="text-align: center" data-col-id='row_total_admin' data-col-group='row_total'>{{ total_ind_admin }}</td>
                                                <td class="filiTable" style="text-align: center" data-col-group='total_row_attache'>{{ total_ind.r15123 }}</td>
                                                <td class="filiTable" style="text-align: center" data-col-group='total_row_attache'>{{ total_ind.r15124 }}</td>
                                                <td class="filiTable" style="text-align: center" data-col-id='total_row_attache' data-col-group='row_total'>{{total_ind_attache}}</td>
                                                <td class="filiTable" style="text-align: center" data-col-group='total_row_ingenieur_en_chef'>{{total_ind.r15125}}</td>
                                                <td class="filiTable" style="text-align: center" data-col-group='total_row_ingenieur_en_chef'>{{ total_ind.r15126 }}</td>
                                                <td class="filiTable" style="text-align: center" data-col-id='total_row_ingenieur_en_chef' data-col-group='row_total'>{{total_ind_ingenieur_en_chef}}</td>
                                                <td class="filiTable" style="text-align: center" data-col-group='total_row_ingenieur'>{{total_ind.r15127}}</td>
                                                <td class="filiTable" style="text-align: center" data-col-group='total_row_ingenieur'>{{total_ind.r15128}}</td>
                                                <td class="filiTable" style="text-align: center" data-col-id='total_row_ingenieur' data-col-group='row_total'>{{total_ind_ingenieur}}</td>
                                                <td class="filiTable" style="text-align: center" data-col-group='total_row_autres'>{{total_ind.r15129}}</td>
                                                <td class="filiTable" style="text-align: center" data-col-group='total_row_autres'>{{ total_ind.r151210 }}</td>
                                                <td class="filiTable" style="text-align: center" data-col-id='total_row_autres' data-col-group='row_total'>{{ total_ind_autres }}</td>
                                                <td class="filiTable" style="text-align: center" data-col-id='row_total'>{{ total_all }}</td>
                    </tr>
                {% endif %}
            </tbody>
        </table>

        <br/>

        <table width="100%"  id="ind1513Table" class="table table-striped table-hover table-bordered">
            <thead>
                <tr>
                    <th class="th-tableau-ind" rowspan="2">Arrivées en {{AnneeCamp}}</th>
                    <th colspan="2" style="text-align: center">Contractuels sur emplois permanents</th>
                    <th class="filiTable" rowspan="2" style="text-align: center">Total</th>
                </tr>
                <tr>
                    <th style="text-align: center">Hommes</th>
                    <th style="text-align: center">Femmes</th>
                </tr>
            </thead>
            <tbody  class="ind_table_totaux">
                {% for tag in formEffectif151.ind1513s %}
                    {% set row_data = tag.vars.value %}
                    {% set total_row_tot= row_data.r15131 + row_data.r15132 %}
                    <tr>
                        <td style="min-width: 400px">{{ form_widget(tag.refEmploiFonctionnel) }}
                            {{ tag.refEmploiFonctionnel.vars.data.lbEmplfonc }}
                        </td>
                        <td id="r15131" style="text-align: center" data-col-group="total_row_tot">{{ form_widget(tag.r15131) }}</td>
                        <td id="r15132" style="text-align: center" data-col-group="total_row_tot">{{ form_widget(tag.r15132) }}</td>
                        <td id="r15132" class="filiTable" style="text-align: center" data-col-id="total_row_tot" data-col-group='total_ind_tot'>{{ total_row_tot }}</td>
                    </tr>
                {% endfor %}
                {% if formEffectif151.ind1513s.count() > 0  %}
                    {% set total_ind = bilan_social_consolide.getIndPileForBy('ind1513s') %}
                    {% set total_ind_tot = total_ind.r15131 + total_ind.r15132 %}
                    <tr id="total1513" class="row_totaux">
                        <td style="min-width: 400px"><b>TOTAL EMPLOIS FONCTIONNELS</b></td>
                        <td class="filiTable" style="text-align: center" data-col-group='total_row_tot'>{{ total_ind.r15131 }}</td>
                        <td class="filiTable" style="text-align: center" data-col-group='total_row_tot'>{{ total_ind.r15132 }}</td>
                        <td class="filiTable" style="text-align: center" data-col-id='total_row_tot'>{{ total_ind_tot }}</td>
                    </tr>
                {% endif %}
            </tbody>
        </table>

        <br/>


        <input class="btn button-tableau pull-right" type="submit" value="Enregistrer et valider les contrôles de cohérence" name="valider" onclick="recordAuto = false;
                $('#progImg').show();" data-valide="1" />

        <img id="progImg" src="{{ asset("img/progress.gif") }}" style="display:none"/>

        {{ form_end(formEffectif151) }}

        <script type="text/javascript">

            $(document).ready(function ()
            {
                changeDetect = false;
                {% include 'stickyheader.txt' %}
                getBrowserSetSticky(ind1511Table);  
                getBrowserSetSticky(ind1512Table);  
                getBrowserSetSticky(ind1513Table);  
   
                // TABLEAU 151X
            {% if questionCollectiviteConsolide.q7 == true  %}
                    // Manip pour cacher la liste des Empl Fct pour en afficher que le libellé tout en conservant l'id à  submit
                    $(document).change();

                    // update1511(true);
                    // update1512(true);
                    // update1513(true);
            {% endif %}

                });


                /*
                 * METHODES Tableau 1.5.1.X
                 */
{#            {% if questionCollectiviteConsolide.q7 == true %}#}
                // function changedR1511(obj) {
                //     update1511(false);
                // }
                // function changedR1512(obj) {
                //     update1512(false);
                // }
                // function changedR1513(obj) {
                //     update1513(false);
                // }

                // function update1511(onInit) {
                //     var table1511 = document.getElementById('ind1511Table');
                //     var rowLength1511 = table1511.rows.length;
                //     var idxRowInput = 0;
                //     if (navigator.userAgent.search("Firefox") >= 0) {
                //         idxRowInput = 3;
                //     }
                //     var mtTot1 = 0;
                //     var mtTot2 = 0;
                //     var mtTot3 = 0;
                //     var mtTot4 = 0;
                //     var mtTot5 = 0;
                //     var mtTot6 = 0;
                //     var mtTot7 = 0;
                //     var mtTot8 = 0;
                //     var mtTot9 = 0;
                //     var mtTot10 = 0;
                //     var mtTot1Emp = 0;
                //     var mtTot2Emp = 0;
                //     var mtTot3Emp = 0;
                //     var mtTot4Emp = 0;
                //     var mtTot5Emp = 0;
                //     var mtTot6Emp = 0;
                //     var mtTot7Emp = 0;
                //     var mtTot8Emp = 0;
                //     var mtTot9Emp = 0;
                //     var mtTot10Emp = 0;
                //     for (var i = 3; i < rowLength1511; i += 1) {
                //         var row = table1511.rows[i];
                //         var cellLength = row.cells.length;
                //         var lineTotalEmp = false;
                //         if (row.id.substring(0, 9) == "total1511") {
                //             lineTotalEmp = true;
                //             for (var y = 0; y < cellLength; y += 1) {
                //                 var cell = row.cells[y];
                //                 if (y == 1) {
                //                     cell.innerHTML = mtTot1;
                //                     mtTot1 = 0;
                //                 } else if (y == 2) {
                //                     cell.innerHTML = mtTot2;
                //                     mtTot2 = 0;
                //                 } else if (y == 3) {
                //                     cell.innerHTML = mtTot3;
                //                     mtTot3 = 0;
                //                 } else if (y == 4) {
                //                     cell.innerHTML = mtTot4;
                //                     mtTot4 = 0;
                //                 } else if (y == 5) {
                //                     cell.innerHTML = mtTot5;
                //                     mtTot5 = 0;
                //                 } else if (y == 6) {
                //                     cell.innerHTML = mtTot6;
                //                     mtTot6 = 0;
                //                 } else if (y == 7) {
                //                     cell.innerHTML = mtTot7;
                //                     mtTot7 = 0;
                //                 } else if (y == 8) {
                //                     cell.innerHTML = mtTot8;
                //                     mtTot8 = 0;
                //                 } else if (y == 9) {
                //                     cell.innerHTML = mtTot9;
                //                     mtTot9 = 0;
                //                 } else if (y == 10) {
                //                     cell.innerHTML = mtTot10;
                //                     mtTot10 = 0;
                //                 }
                //             }
                //         }
                //
                //         for (var y = 0; y < cellLength; y += 1) {
                //             var cell = row.cells[y];
                //
                //             if (cell.id.substring(0, 6) == "r15112") {
                //                 if ($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15112').val() != "") {
                //                     mtTot2 += parseInt($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15112').val());
                //                     mtTot2Emp += parseInt($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15112').val());
                //                 }
                //             } else if (cell.id.substring(0, 6) == "r15113") {
                //                 if ($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15113').val() != "") {
                //                     mtTot3 += parseInt($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15113').val());
                //                     mtTot3Emp += parseInt($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15113').val());
                //                 }
                //             } else if (cell.id.substring(0, 6) == "r15114") {
                //                 if ($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15114').val() != "") {
                //                     mtTot4 += parseInt($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15114').val());
                //                     mtTot4Emp += parseInt($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15114').val());
                //                 }
                //             } else if (cell.id.substring(0, 6) == "r15115") {
                //                 if ($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15115').val() != "") {
                //                     mtTot5 += parseInt($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15115').val());
                //                     mtTot5Emp += parseInt($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15115').val());
                //                 }
                //             } else if (cell.id.substring(0, 6) == "r15116") {
                //                 if ($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15116').val() != "") {
                //                     mtTot6 += parseInt($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15116').val());
                //                     mtTot6Emp += parseInt($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15116').val());
                //                 }
                //             } else if (cell.id.substring(0, 6) == "r15117") {
                //                 if ($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15117').val() != "") {
                //                     mtTot7 += parseInt($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15117').val());
                //                     mtTot7Emp += parseInt($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15117').val());
                //                 }
                //             } else if (cell.id.substring(0, 6) == "r15118") {
                //                 if ($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15118').val() != "") {
                //                     mtTot8 += parseInt($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15118').val());
                //                     mtTot8Emp += parseInt($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15118').val());
                //                 }
                //             } else if (cell.id.substring(0, 6) == "r15119") {
                //                 if ($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15119').val() != "") {
                //                     mtTot9 += parseInt($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15119').val());
                //                     mtTot9Emp += parseInt($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15119').val());
                //                 }
                //             } else if (cell.id.substring(0, 7) == "r151110") {
                //                 if ($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r151110').val() != "") {
                //                     mtTot10 += parseInt($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r151110').val());
                //                     mtTot10Emp += parseInt($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r151110').val());
                //                 }
                //             } else if (cell.id.substring(0, 6) == "r15111") {
                //                 if ($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15111').val() != "") {
                //                     mtTot1 += parseInt($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15111').val());
                //                     mtTot1Emp += parseInt($('#bscForm151_ind1511s_' + (idxRowInput - 3) + '_r15111').val());
                //                 }
                //             }
                //         }
                //
                //         if (!lineTotalEmp)
                //             idxRowInput++;
                //     }// end for line
                //
                //     if (!onInit) {
                //
                //     }
                //
                // }
                //
                // function update1512(onInit) {
                //     var table1512 = document.getElementById('ind1512Table');
                //     var rowLength1512 = table1512.rows.length;
                //     var idxRowInput = 0;
                //     if (navigator.userAgent.search("Firefox") >= 0) {
                //         idxRowInput = 3;
                //     }
                //     var mtTot1 = 0;
                //     var mtTot2 = 0;
                //     var mtTot3 = 0;
                //     var mtTot4 = 0;
                //     var mtTot5 = 0;
                //     var mtTot6 = 0;
                //     var mtTot7 = 0;
                //     var mtTot8 = 0;
                //     var mtTot9 = 0;
                //     var mtTot10 = 0;
                //     var mtTot1Emp = 0;
                //     var mtTot2Emp = 0;
                //     var mtTot3Emp = 0;
                //     var mtTot4Emp = 0;
                //     var mtTot5Emp = 0;
                //     var mtTot6Emp = 0;
                //     var mtTot7Emp = 0;
                //     var mtTot8Emp = 0;
                //     var mtTot9Emp = 0;
                //     var mtTot10Emp = 0;
                //     for (var i = 3; i < rowLength1512; i += 1) {
                //         var row = table1512.rows[i];
                //         var cellLength = row.cells.length;
                //         var lineTotalEmp = false;
                //         if (row.id.substring(0, 9) == "total1512") {
                //             lineTotalEmp = true;
                //             for (var y = 0; y < cellLength; y += 1) {
                //                 var cell = row.cells[y];
                //                 if (y == 1) {
                //                     cell.innerHTML = mtTot1;
                //                     mtTot1 = 0;
                //                 } else if (y == 2) {
                //                     cell.innerHTML = mtTot2;
                //                     mtTot2 = 0;
                //                 } else if (y == 3) {
                //                     cell.innerHTML = mtTot3;
                //                     mtTot3 = 0;
                //                 } else if (y == 4) {
                //                     cell.innerHTML = mtTot4;
                //                     mtTot4 = 0;
                //                 } else if (y == 5) {
                //                     cell.innerHTML = mtTot5;
                //                     mtTot5 = 0;
                //                 } else if (y == 6) {
                //                     cell.innerHTML = mtTot6;
                //                     mtTot6 = 0;
                //                 } else if (y == 7) {
                //                     cell.innerHTML = mtTot7;
                //                     mtTot7 = 0;
                //                 } else if (y == 8) {
                //                     cell.innerHTML = mtTot8;
                //                     mtTot8 = 0;
                //                 } else if (y == 9) {
                //                     cell.innerHTML = mtTot9;
                //                     mtTot9 = 0;
                //                 } else if (y == 10) {
                //                     cell.innerHTML = mtTot10;
                //                     mtTot10 = 0;
                //                 }
                //             }
                //         }
                //
                //         for (var y = 0; y < cellLength; y += 1) {
                //             var cell = row.cells[y];
                //
                //             if (cell.id.substring(0, 6) == "r15122") {
                //                 if ($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15122').val() != "") {
                //                     mtTot2 += parseInt($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15122').val());
                //                     mtTot2Emp += parseInt($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15122').val());
                //                 }
                //             } else if (cell.id.substring(0, 6) == "r15123") {
                //                 if ($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15123').val() != "") {
                //                     mtTot3 += parseInt($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15123').val());
                //                     mtTot3Emp += parseInt($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15123').val());
                //                 }
                //             } else if (cell.id.substring(0, 6) == "r15124") {
                //                 if ($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15124').val() != "") {
                //                     mtTot4 += parseInt($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15124').val());
                //                     mtTot4Emp += parseInt($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15124').val());
                //                 }
                //             } else if (cell.id.substring(0, 6) == "r15125") {
                //                 if ($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15125').val() != "") {
                //                     mtTot5 += parseInt($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15125').val());
                //                     mtTot5Emp += parseInt($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15125').val());
                //                 }
                //             } else if (cell.id.substring(0, 6) == "r15126") {
                //                 if ($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15126').val() != "") {
                //                     mtTot6 += parseInt($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15126').val());
                //                     mtTot6Emp += parseInt($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15126').val());
                //                 }
                //             } else if (cell.id.substring(0, 6) == "r15127") {
                //                 if ($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15127').val() != "") {
                //                     mtTot7 += parseInt($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15127').val());
                //                     mtTot7Emp += parseInt($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15127').val());
                //                 }
                //             } else if (cell.id.substring(0, 6) == "r15128") {
                //                 if ($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15128').val() != "") {
                //                     mtTot8 += parseInt($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15128').val());
                //                     mtTot8Emp += parseInt($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15128').val());
                //                 }
                //             } else if (cell.id.substring(0, 6) == "r15129") {
                //                 if ($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15129').val() != "") {
                //                     mtTot9 += parseInt($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15129').val());
                //                     mtTot9Emp += parseInt($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15129').val());
                //                 }
                //             } else if (cell.id.substring(0, 7) == "r151210") {
                //                 if ($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r151210').val() != "") {
                //                     mtTot10 += parseInt($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r151210').val());
                //                     mtTot10Emp += parseInt($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r151210').val());
                //                 }
                //             } else if (cell.id.substring(0, 6) == "r15121") {
                //                 if ($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15121').val() != "") {
                //                     mtTot1 += parseInt($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15121').val());
                //                     mtTot1Emp += parseInt($('#bscForm151_ind1512s_' + (idxRowInput - 3) + '_r15121').val());
                //                 }
                //             }
                //
                //         }
                //
                //         if (!lineTotalEmp)
                //             idxRowInput++;
                //     }// end for line
                //
                //     if (!onInit) {
                //
                //     }
                //
                // }
                //
                // function update1513(onInit) {
                //     var table1513 = document.getElementById('ind1513Table');
                //     var rowLength1513 = table1513.rows.length;
                //     var idxRowInput = 0;
                //     if (navigator.userAgent.search("Firefox") >= 0) {
                //         idxRowInput = 2;
                //     }
                //     var mtTot1 = 0;
                //     var mtTot2 = 0;
                //     var mtTot1Emp = 0;
                //     var mtTot2Emp = 0;
                //     for (var i = 2; i < rowLength1513; i += 1) {
                //         var row = table1513.rows[i];
                //         var cellLength = row.cells.length;
                //         var lineTotalEmp = false;
                //         if (row.id.substring(0, 9) == "total1513") {
                //             lineTotalEmp = true;
                //             for (var y = 0; y < cellLength; y += 1) {
                //                 var cell = row.cells[y];
                //                 if (y == 1) {
                //                     cell.innerHTML = mtTot1;
                //                     mtTot1 = 0;
                //                 } else if (y == 2) {
                //                     cell.innerHTML = mtTot2;
                //                     mtTot2 = 0;
                //                 }
                //
                //             }
                //         }
                //
                //         for (var y = 0; y < cellLength; y += 1) {
                //             var cell = row.cells[y];
                //             if (cell.id.substring(0, 6) == "r15131") {
                //                 if ($('#bscForm151_ind1513s_' + (idxRowInput - 2) + '_r15131').val() != "") {
                //                     mtTot1 += parseInt($('#bscForm151_ind1513s_' + (idxRowInput - 2) + '_r15131').val());
                //                     mtTot1Emp += parseInt($('#bscForm151_ind1513s_' + (idxRowInput - 2) + '_r15131').val());
                //                 }
                //             } else if (cell.id.substring(0, 6) == "r15132") {
                //                 if ($('#bscForm151_ind1513s_' + (idxRowInput - 2) + '_r15132').val() != "") {
                //                     mtTot2 += parseInt($('#bscForm151_ind1513s_' + (idxRowInput - 2) + '_r15132').val());
                //                     mtTot2Emp += parseInt($('#bscForm151_ind1513s_' + (idxRowInput - 2) + '_r15132').val());
                //                 }
                //             }
                //
                //         }
                //
                //         if (!lineTotalEmp)
                //             idxRowInput++;
                //     }// end for line
                //
                //     if (!onInit) {
                //
                //     }
                //
                // }

{#            {% endif %}#}

                /*
                 * METHODE AJAX SUBMIT
                 */
                $(function () {
                    // Enregistrement en ajax
                    $('form').on('submit', function (e) {
                        var $this = $(this).closest('div');
                        var btn = $(this).find("input[type=submit]:focus");
                        var value_valide = $(btn).data('valide');
                        $('#bscForm151_valide').val(value_valide);

                        // Submit en ajax pour le fonctionnement d'appel par onglet // $('form').serialize(), 'valide': test
                        e.preventDefault();
                        $.ajax({
                            type: 'post',
                            url: '{{ path('bilan_conso_effectif_ind151_edit') }}',
                            data: $('form').serialize(),
                            success: function (responsejson) {
                                if (responsejson.data == 1) {
                                    if (recordAuto) {
                                        $('#progImg').hide();
                                        $('#messageJS').html("Enregistrement automatique réussi");
                                        messageJS.dialog("open");
                                        setIncoherenceTable(responsejson);
                                    } else {
                                        $('#ind151').load('{{ path('bilan_conso_effectif_ind151_edit') }}', function () {
                                            $('#progImg').hide();
                                            $('#messageJS').html("Enregistrement réussi");
                                            messageJS.dialog("open");
                                            setIncoherenceTable(responsejson);

                                            var next = $($this).next('.panel-heading');
                                            if(next.length == 0) {
                                                window.location.href = '{{ path('bilan_conso_tpstrav_edit') }}';
                                            }
                                        });

                                    }
                                } else if (responsejson.data == "-3") {
                                    $('#progImg').hide();
                                    $('#messageJS').html("{{'erreur.unique.violation'|trans}}");
                                    messageJS.dialog("open");
                                } else {
                                    $('#progImg').hide();
                                    $('#messageJS').html("Une erreur s'est produite dans l'enregistrement 1");
                                    messageJS.dialog("open");
                                }


                            },
                            error: function (xhr, status, error) {
                                //alert(xhr);
                                $('#progImg').hide();
                                $('#messageJS').html("Une erreur s'est produite dans l'enregistrement : ");
                                messageJS.dialog("open");
                            }

                        });
                    });
                }
                )
                        ;

        </script>
    {% endif %}
