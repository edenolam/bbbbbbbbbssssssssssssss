

    {% if formTpsTrav211 is defined %}
        {% set bilan_social_consolide = formTpsTrav211.vars.data %}
        {{ form_start(formTpsTrav211) }}

            <table width="100%" id="ind2111Table" class="table table-striped table-hover table-bordered">
                <thead>
                    <tr>
                        <th colspan="2" rowspan="2" style="text-align: center"></th>
                        <th colspan="3" style="text-align: center">Nombre de fonctionnaires
                                (titulaires et stagiaires) *</th>
                        <th colspan="3" style="text-align: center">Nombre de journées d'absence (en jours calendaires)</th>
                        <th colspan="3" style="text-align: center">Nombre d'arrêts**</th>
                    </tr>
                    <tr>
                        <th style="text-align: center">Hommes</th>
                        <th style="text-align: center">Femmes</th>
                        <th style="text-align: center">Total</th>
                        <th style="text-align: center">Hommes</th>
                        <th style="text-align: center">Femmes</th>
                        <th style="text-align: center">Total</th>
                        <th style="text-align: center">Hommes</th>
                        <th style="text-align: center">Femmes</th>
                        <th style="text-align: center">Total</th>
                    </tr>
                </thead>
                <tbody class="ind_table_totaux">

                {% for tag in formTpsTrav211.ind2111s %}
                    {% set row_data = tag.vars.value %}
                    {% set total_fonc = row_data.r21111 + row_data.r21112 %}
                    {% set total_abs = row_data.r21113 + row_data.r21114 %}
                    {% set total_arr = row_data.r21115 + row_data.r21116 %}
                    <tr idTrMa="{{tag.refMotifAbsence.vars.value}}" id="2111idMa_{{tag.refMotifAbsence.vars.value}}">
                        {% if tag.nbRowspan.vars.value != null  %}
                        <td style="min-width: 100px" rowspan="{{tag.nbRowspan.vars.value}}">
                            {% if tag.refMotifAbsence.vars.data.blAbsecomp == true %}
                                Médical compressible
                            {% endif %}
                            {% if tag.refMotifAbsence.vars.data.blAbsemedi == true %}
                                Médical non compressible
                            {% endif %}
                            {% if tag.refMotifAbsence.vars.data.blAbseautrrais == true %}
                                Autres raisons
                            {% endif %}
                        </td>
                        {% endif %}

                        <td style="min-width: 300px">
                            {{ form_widget(tag.refMotifAbsence) }}

                            {{ form_widget(tag.nbRowspan) }}

                            {{ tag.refMotifAbsence.vars.data.lbMotiabse}}
                        </td>

                        <td id="r21111" data-col-group='row_fonc'>
                            {% if tag.refMotifAbsence.vars.data.cdMotiabse != 'ABS006' %}
                                {{ form_widget(tag.r21111) }}
                            {% endif %}
                            {% if tag.refMotifAbsence.vars.data.cdMotiabse == 'ABS006' %}
                                <div style="display : none">
                                {{ form_widget(tag.r21111) }}
                                </div>
                            {% endif %}
                        </td>
                        <td id="r21112" data-col-group='row_fonc'>{{ form_widget(tag.r21112) }}</td>
                        <td data-col-id='row_fonc'>{{ total_fonc }}</td>
                        <td id="r21113" data-col-group='row_abs'>
                            {% if tag.refMotifAbsence.vars.data.cdMotiabse != 'ABS006' %}
                                {{ form_widget(tag.r21113) }}
                            {% endif %}
                            {% if tag.refMotifAbsence.vars.data.cdMotiabse == 'ABS006' %}
                                <div style="display : none">
                                {{ form_widget(tag.r21113) }}
                                </div>
                            {% endif %}
                        </td>
                        <td id="r21114" data-col-group='row_abs'>{{ form_widget(tag.r21114) }}</td>
                        <td data-col-id='row_abs'>{{ total_abs }}</td>
                        <td id="r21115" data-col-group='row_arr'>
                            {% if tag.refMotifAbsence.vars.data.cdMotiabse != 'ABS006' and tag.refMotifAbsence.vars.data.cdMotiabse != 'ABS008'  %}
                                {{ form_widget(tag.r21115) }}
                            {% endif %}
                            {% if tag.refMotifAbsence.vars.data.cdMotiabse == 'ABS006' or tag.refMotifAbsence.vars.data.cdMotiabse == 'ABS008'  %}
                                <div style="display : none">
                                {{ form_widget(tag.r21115) }}
                                </div>
                            {% endif %}
                        </td>
                        <td id="r21116" data-col-group='row_arr'>
                            {% if tag.refMotifAbsence.vars.data.cdMotiabse != 'ABS008'  %}
                                {{ form_widget(tag.r21116) }}
                            {% endif %}
                            {% if tag.refMotifAbsence.vars.data.cdMotiabse == 'ABS008' %}
                                <div style="display : none">
                                {{ form_widget(tag.r21116) }}
                                </div>
                            {% endif %}
                        </td>
                        <td data-col-id='row_arr'>{{ total_arr }}</td>
                    </tr>

                {% endfor %}
                {% set total_row = bilan_social_consolide.getIndPileForBy('ind2111s') %}
                {% set total_row_fonc = total_row.r21111 + total_row.r21112 %}
                {% set total_row_abs  = total_row.r21113 + total_row.r21114 %}
                {% set total_row_att  = total_row.r21115 + total_row.r21116 %}
                 <tr class="filiTable row_totaux" id="total">
                    <th class="filiTable" colspan="2" style="text-align: center">Total</th>
                    <th class="filiTable" style="text-align: center" data-col-group='total_all_fonc'>{{ total_row.r21111 }}</th>
                    <th class="filiTable" style="text-align: center" data-col-group='total_all_fonc'>{{ total_row.r21112 }}</th>
                    <th class="filiTable" style="text-align: center" data-col-id='total_all_fonc'>{{ total_row_fonc }}</th>
                    <th class="filiTable" style="text-align: center" data-col-group='total_all_abs'>{{ total_row.r21113 }}</th>
                    <th class="filiTable" style="text-align: center" data-col-group='total_all_abs'>{{ total_row.r21114 }}</th>
                    <th class="filiTable" style="text-align: center" data-col-id='total_all_abs'>{{ total_row_abs }}</th>
                    <th class="filiTable" style="text-align: center" data-col-group='total_all_att'>{{ total_row.r21115 }}</th>
                    <th class="filiTable" style="text-align: center" data-col-group='total_all_att'>{{ total_row.r21116 }}</th>
                    <th class="filiTable" style="text-align: center" data-col-id='total_all_att'>{{ total_row_att }}</th>
                </tr>
                </tbody>
            </table>


            <i>
            * Si un agent a été absent sur plusieurs périodes dans l'année, ne le compter qu'une seule fois.<br/>
            ** Si un arrêt est prolongé, ne le compter qu'une seule fois.  <br/>
            <br/>
            Les congés pour couches pathologiques sont à inclure : <br/>
             (1) - en congé maternité pour les fonctionnaires<br/>
             - en congé maladie pour les contractuels<br/>
            </i>
            <br/><br/>

            <table width="100%" id="ind2112Table" class="table table-striped table-hover table-bordered">
                <thead>
                    <tr>
                        <th rowspan="2" colspan="2" style="text-align: center"></th>
                        <th colspan="11" style="text-align: center">Nombre de fonctionnaires (titulaires et stagiaires) *</th>
                    </tr>
                    <tr>
                        <th style="text-align: center">Moins de 25 ans</th>
                        <th style="text-align: center">25 ans à 29 ans</th>
                        <th style="text-align: center">30 ans à 34 ans</th>
                        <th style="text-align: center">35 ans à 39 ans</th>
                        <th style="text-align: center">40 ans à 44 ans</th>
                        <th style="text-align: center">45 ans à 49 ans</th>
                        <th style="text-align: center">50 ans à 54 ans</th>
                        <th style="text-align: center">55 ans à 59 ans</th>
                        <th style="text-align: center">60 ans à 64 ans</th>
                        <th style="text-align: center">65 ans et plus</th>
                        <th class="filiTable" style="text-align: center">Total</th>
                    </tr>
                </thead>
                <tbody>

                {% for tag in formTpsTrav211.ind2112s %}
                    <tr idTrMa="{{tag.refMotifAbsence.vars.value}}" id="2112idMa_{{tag.refMotifAbsence.vars.value}}">
                        {% if tag.nbRowspan.vars.value != null  %}
                        <td style="min-width: 100px" rowspan="{{tag.nbRowspan.vars.value}}">
                            {% if tag.refMotifAbsence.vars.data.blAbsecomp == true %}
                                Médical compressible
                            {% endif %}
                            {% if tag.refMotifAbsence.vars.data.blAbsemedi == true %}
                                Médical non compressible
                            {% endif %}

                        </td>
                        {% endif %}

                        <td style="min-width: 300px">
                            {{ form_widget(tag.refMotifAbsence) }}
                            {{ form_widget(tag.nbRowspan) }}
                            {{ form_widget(tag.total2111) }}
                            {{ tag.refMotifAbsence.vars.data.lbMotiabse}}
                            <br/>
                            <span class="alerteConso">[2.1.1.1] = {{ tag.vars.value.total2111 }}</span>
                        </td>

                        <td id="r21121">{{ form_widget(tag.r21121) }}</td>
                        <td id="r21122">{{ form_widget(tag.r21122) }}</td>
                        <td id="r21123">{{ form_widget(tag.r21123) }}</td>
                        <td id="r21124">{{ form_widget(tag.r21124) }}</td>
                        <td id="r21125">{{ form_widget(tag.r21125) }}</td>
                        <td id="r21126">{{ form_widget(tag.r21126) }}</td>
                        <td id="r21127">{{ form_widget(tag.r21127) }}</td>
                        <td id="r21128">{{ form_widget(tag.r21128) }}</td>
                        <td id="r21129">{{ form_widget(tag.r21129) }}</td>
                        <td id="r211210">{{ form_widget(tag.r211210) }}</td>
                        <td class="filiTable" id="lineTot1" style="text-align: center">0</td>
                    </tr>

                {% endfor %}
                 <tr class="filiTable" id="total">
                    <th class="filiTable" colspan="2" style="text-align: center">Total</th>
                    <th class="filiTable" style="text-align: center">0</th>
                    <th class="filiTable" style="text-align: center">0</th>
                    <th class="filiTable" style="text-align: center">0</th>
                    <th class="filiTable" style="text-align: center">0</th>
                    <th class="filiTable" style="text-align: center">0</th>
                    <th class="filiTable" style="text-align: center">0</th>
                    <th class="filiTable" style="text-align: center">0</th>
                    <th class="filiTable" style="text-align: center">0</th>
                    <th class="filiTable" style="text-align: center">0</th>
                    <th class="filiTable" style="text-align: center">0</th>
                    <th class="filiTable" style="text-align: center">0</th>
                </tr>
                </tbody>
            </table>



            <i>* si un agent a été absent sur plusieurs périodes dans l'année, ne le compter qu'une seule fois</i>
            <br/><br/>


            <table width="100%" id="ind2113Table" class="table table-striped table-hover table-bordered">
                <thead>
                    <tr>
                        <th rowspan="2" colspan="2" style="text-align: center"></th>
                        <th colspan="11" style="text-align: center">Nombre de journées d'absence</th>
                    </tr>
                    <tr>
                        <th style="text-align: center">Moins de 25 ans</th>
                        <th style="text-align: center">25 ans à 29 ans</th>
                        <th style="text-align: center">30 ans à 34 ans</th>
                        <th style="text-align: center">35 ans à 39 ans</th>
                        <th style="text-align: center">40 ans à 44 ans</th>
                        <th style="text-align: center">45 ans à 49 ans</th>
                        <th style="text-align: center">50 ans à 54 ans</th>
                        <th style="text-align: center">55 ans à 59 ans</th>
                        <th style="text-align: center">60 ans à 64 ans</th>
                        <th style="text-align: center">65 ans et plus</th>
                        <th class="filiTable" style="text-align: center">Total</th>
                    </tr>
                </thead>
                <tbody>

                {% for tag in formTpsTrav211.ind2113s %}
                    <tr idTrMa="{{tag.refMotifAbsence.vars.value}}" id="2113idMa_{{tag.refMotifAbsence.vars.value}}">
                        {% if tag.nbRowspan.vars.value != null  %}
                        <td style="min-width: 100px" rowspan="{{tag.nbRowspan.vars.value}}">
                            {% if tag.refMotifAbsence.vars.data.blAbsecomp == true %}
                                Médical compressible
                            {% endif %}
                            {% if tag.refMotifAbsence.vars.data.blAbsemedi == true %}
                                Médical non compressible
                            {% endif %}
                        </td>
                        {% endif %}

                        <td style="min-width: 300px">
                            {{ form_widget(tag.refMotifAbsence) }}
                            {{ form_widget(tag.nbRowspan) }}
                            {{ form_widget(tag.total2111) }}
                            {{ tag.refMotifAbsence.vars.data.lbMotiabse}}
                            <br/>
                            <span class="alerteConso">[2.1.1.1] = {{ tag.vars.value.total2111 }}</span>
                        </td>

                        <td id="r21131">{{ form_widget(tag.r21131) }}</td>
                        <td id="r21132">{{ form_widget(tag.r21132) }}</td>
                        <td id="r21133">{{ form_widget(tag.r21133) }}</td>
                        <td id="r21134">{{ form_widget(tag.r21134) }}</td>
                        <td id="r21135">{{ form_widget(tag.r21135) }}</td>
                        <td id="r21136">{{ form_widget(tag.r21136) }}</td>
                        <td id="r21137">{{ form_widget(tag.r21137) }}</td>
                        <td id="r21138">{{ form_widget(tag.r21138) }}</td>
                        <td id="r21139">{{ form_widget(tag.r21139) }}</td>
                        <td id="r211310">{{ form_widget(tag.r211310) }}</td>
                        <td class="filiTable" id="lineTot1" style="text-align: center">0</td>
                    </tr>

                {% endfor %}
                 <tr class="filiTable" id="total">
                    <th class="filiTable" colspan="2" style="text-align: center">Total</th>
                    <th class="filiTable" style="text-align: center">0</th>
                    <th class="filiTable" style="text-align: center">0</th>
                    <th class="filiTable" style="text-align: center">0</th>
                    <th class="filiTable" style="text-align: center">0</th>
                    <th class="filiTable" style="text-align: center">0</th>
                    <th class="filiTable" style="text-align: center">0</th>
                    <th class="filiTable" style="text-align: center">0</th>
                    <th class="filiTable" style="text-align: center">0</th>
                    <th class="filiTable" style="text-align: center">0</th>
                    <th class="filiTable" style="text-align: center">0</th>
                    <th class="filiTable" style="text-align: center">0</th>
                </tr>
                </tbody>
            </table>

            <br/>

            <input class="btn button-tableau pull-right" type="submit" value="Enregistrer et valider les contrôles de cohérence" name="valider" onclick="recordAuto = false;
                    $('#progImg').show();" data-valide="1" />

            <img id="progImg" src="{{ asset("img/progress.gif") }}" style="display:none"/>

        {{ form_end(formTpsTrav211) }}


        <script type="text/javascript">

        $(document).ready(function ()
        {
            changeDetect = false;

            {% if questionCollectiviteConsolide.q1 == true   %}
                $(document).change();
                // update2111();
                update2112();
                update2113();

            {% endif %}
        });

        function changedR2111(obj) {
            // update2111();
        }

        function changedR2112(obj) {
            update2112();
        }

        function changedR2113(obj) {
            update2113();
        }

        function update2111(){
            var table2111 = document.getElementById('ind2111Table');

            var rowLength2111 = table2111.rows.length;
            var idxRowInput = 0;
            var mtTot1 = 0;
            var mtTot2 = 0;
            var mtTot3 = 0;
            var mtTot4 = 0;
            var mtTot5 = 0;
            var mtTot6 = 0;

            for(var i=2; i<rowLength2111; i+=1){
                // contenu de la ligne entière
                var row = table2111.rows[i];
                // nombre de cellule sur la ligne
                var cellLength = row.cells.length;

                var lineTotal = false;

                if(row.id.substring(0, 5)=="total") {
                    lineTotal = true;

                    for(var y=0; y<cellLength; y+=1){
                        var cell = row.cells[y];
                        if(y==1) {
                            cell.innerHTML = mtTot1;
                            mtTot1 = 0;
                        }
                        else if(y==2) {
                            cell.innerHTML = mtTot2;
                            mtTot2 = 0;
                        }
                        else if(y==3) {
                            cell.innerHTML = mtTot3;
                            mtTot3 = 0;
                        }
                        else if(y==4) {
                            cell.innerHTML = mtTot4;
                            mtTot4 = 0;
                        }
                        else if(y==5) {
                            cell.innerHTML = mtTot5;
                            mtTot5 = 0;
                        }
                        else if(y==6) {
                            cell.innerHTML = mtTot6;
                            mtTot6 = 0;
                        }

                    }
                }

                for(var y=0; y<cellLength; y+=1){
                    var cell = row.cells[y];
                    if(cell.id.substring(0, 6)=="r21111") {
                        if($('#bscForm211_ind2111s_'+idxRowInput+'_r21111').val()!="") {
                            mtTot1 += parseInt($('#bscForm211_ind2111s_'+idxRowInput+'_r21111').val());
                        }
                    }
                    else if(cell.id.substring(0, 6)=="r21112") {
                        if($('#bscForm211_ind2111s_'+idxRowInput+'_r21112').val()!="") {
                            mtTot2 += parseInt($('#bscForm211_ind2111s_'+idxRowInput+'_r21112').val());
                        }
                    }
                    else if(cell.id.substring(0, 6)=="r21113") {
                        if($('#bscForm211_ind2111s_'+idxRowInput+'_r21113').val()!="") {
                            mtTot3 += parseFloat($('#bscForm211_ind2111s_'+idxRowInput+'_r21113').val());
                        }
                    }
                    else if(cell.id.substring(0, 6)=="r21114") {
                        if($('#bscForm211_ind2111s_'+idxRowInput+'_r21114').val()!="") {
                            mtTot4 += parseFloat($('#bscForm211_ind2111s_'+idxRowInput+'_r21114').val());
                        }
                    }
                    else if(cell.id.substring(0, 6)=="r21115") {
                        if($('#bscForm211_ind2111s_'+idxRowInput+'_r21115').val()!="") {
                            mtTot5 += parseInt($('#bscForm211_ind2111s_'+idxRowInput+'_r21115').val());
                        }
                    }
                    else if(cell.id.substring(0, 6)=="r21116") {
                        if($('#bscForm211_ind2111s_'+idxRowInput+'_r21116').val()!="") {
                            mtTot6 += parseInt($('#bscForm211_ind2111s_'+idxRowInput+'_r21116').val());
                        }
                    }

                }

                if(!lineTotal) idxRowInput++;
            }
        }


        function update2112(){
            var table2112 = document.getElementById('ind2112Table');

            var rowLength2112 = table2112.rows.length;
            var idxRowInput = 0;
            var mtTot1 = 0;
            var mtTot2 = 0;
            var mtTot3 = 0;
            var mtTot4 = 0;
            var mtTot5 = 0;
            var mtTot6 = 0;
            var mtTot7 = 0;
            var mtTot8 = 0;
            var mtTot9 = 0;
            var mtTot10 = 0;

            for(var i=2; i<rowLength2112; i+=1){
                // contenu de la ligne entière
                var row = table2112.rows[i];
                // nombre de cellule sur la ligne
                var cellLength = row.cells.length;

                var lineTotal = false;
                var lineTot1 = 0;

                if(row.id.substring(0, 5)=="total") {
                    lineTotal = true;

                    for(var y=0; y<cellLength; y+=1){
                        var cell = row.cells[y];
                        if(y==1) {
                            cell.innerHTML = mtTot1;
                            lineTot1 += mtTot1;
                            mtTot1 = 0;
                        }
                        else if(y==2) {
                            cell.innerHTML = mtTot2;
                            lineTot1 += mtTot2;
                            mtTot2 = 0;
                        }
                        else if(y==3) {
                            cell.innerHTML = mtTot3;
                            lineTot1 += mtTot3;
                            mtTot3 = 0;
                        }
                        else if(y==4) {
                            cell.innerHTML = mtTot4;
                            lineTot1 += mtTot4;
                            mtTot4 = 0;
                        }
                        else if(y==5) {
                            cell.innerHTML = mtTot5;
                            lineTot1 += mtTot5;
                            mtTot5 = 0;
                        }
                        else if(y==6) {
                            cell.innerHTML = mtTot6;
                            lineTot1 += mtTot6;
                            mtTot6 = 0;
                        }
                        else if(y==7) {
                            cell.innerHTML = mtTot7;
                            lineTot1 += mtTot7;
                            mtTot7 = 0;
                        }
                        else if(y==8) {
                            cell.innerHTML = mtTot8;
                            lineTot1 += mtTot8;
                            mtTot8 = 0;
                        }
                        else if(y==9) {
                            cell.innerHTML = mtTot9;
                            lineTot1 += mtTot9;
                            mtTot9 = 0;
                        }
                        else if(y==10) {
                            cell.innerHTML = mtTot10;
                            lineTot1 += mtTot10;
                            mtTot10 = 0;
                        }
                        else if (y == 11) {
                            cell.innerHTML = lineTot1;
                        }
                    }
                }

                lineTot1 = 0;

                for(var y=0; y<cellLength; y+=1){
                    var cell = row.cells[y];

                    if(cell.id.substring(0, 6)=="r21122") {
                        if($('#bscForm211_ind2112s_'+idxRowInput+'_r21122').val()!="") {
                            mtTot2 += parseInt($('#bscForm211_ind2112s_'+idxRowInput+'_r21122').val());
                            lineTot1 += parseInt($('#bscForm211_ind2112s_'+idxRowInput+'_r21122').val());                        }
                    }
                    else if(cell.id.substring(0, 6)=="r21123") {
                        if($('#bscForm211_ind2112s_'+idxRowInput+'_r21123').val()!="") {
                            mtTot3 += parseInt($('#bscForm211_ind2112s_'+idxRowInput+'_r21123').val());
                            lineTot1 += parseInt($('#bscForm211_ind2112s_'+idxRowInput+'_r21123').val());
                        }
                    }
                    else if(cell.id.substring(0, 6)=="r21124") {
                        if($('#bscForm211_ind2112s_'+idxRowInput+'_r21124').val()!="") {
                            mtTot4 += parseInt($('#bscForm211_ind2112s_'+idxRowInput+'_r21124').val());
                            lineTot1 += parseInt($('#bscForm211_ind2112s_'+idxRowInput+'_r21124').val());
                        }
                    }
                    else if(cell.id.substring(0, 6)=="r21125") {
                        if($('#bscForm211_ind2112s_'+idxRowInput+'_r21125').val()!="") {
                            mtTot5 += parseInt($('#bscForm211_ind2112s_'+idxRowInput+'_r21125').val());
                            lineTot1 += parseInt($('#bscForm211_ind2112s_'+idxRowInput+'_r21125').val());
                        }
                    }
                    else if(cell.id.substring(0, 6)=="r21126") {
                        if($('#bscForm211_ind2112s_'+idxRowInput+'_r21126').val()!="") {
                            mtTot6 += parseInt($('#bscForm211_ind2112s_'+idxRowInput+'_r21126').val());
                            lineTot1 += parseInt($('#bscForm211_ind2112s_'+idxRowInput+'_r21126').val());
                        }
                    }
                    else if(cell.id.substring(0, 6)=="r21127") {
                        if($('#bscForm211_ind2112s_'+idxRowInput+'_r21127').val()!="") {
                            mtTot7 += parseInt($('#bscForm211_ind2112s_'+idxRowInput+'_r21127').val());
                            lineTot1 += parseInt($('#bscForm211_ind2112s_'+idxRowInput+'_r21127').val());
                        }
                    }
                    else if(cell.id.substring(0, 6)=="r21128") {
                        if($('#bscForm211_ind2112s_'+idxRowInput+'_r21128').val()!="") {
                            mtTot8 += parseInt($('#bscForm211_ind2112s_'+idxRowInput+'_r21128').val());
                            lineTot1 += parseInt($('#bscForm211_ind2112s_'+idxRowInput+'_r21128').val());
                        }
                    }
                    else if(cell.id.substring(0, 6)=="r21129") {
                        if($('#bscForm211_ind2112s_'+idxRowInput+'_r21129').val()!="") {
                            mtTot9 += parseInt($('#bscForm211_ind2112s_'+idxRowInput+'_r21129').val());
                            lineTot1 += parseInt($('#bscForm211_ind2112s_'+idxRowInput+'_r21129').val());
                        }
                    }
                    else if(cell.id.substring(0, 7)=="r211210") {
                        if($('#bscForm211_ind2112s_'+idxRowInput+'_r211210').val()!="") {
                            mtTot10 += parseInt($('#bscForm211_ind2112s_'+idxRowInput+'_r211210').val());
                            lineTot1 += parseInt($('#bscForm211_ind2112s_'+idxRowInput+'_r211210').val());
                        }
                    }
                    else if(cell.id.substring(0, 6)=="r21121") {
                        if($('#bscForm211_ind2112s_'+idxRowInput+'_r21121').val()!="") {
                            mtTot1 += parseInt($('#bscForm211_ind2112s_'+idxRowInput+'_r21121').val());
                            lineTot1 += parseInt($('#bscForm211_ind2112s_'+idxRowInput+'_r21121').val());
                        }
                    } else if (cell.id.substring(0, 8) == "lineTot1") {
                        cell.innerHTML = lineTot1;
                    }
                }

                if(!lineTotal) idxRowInput++;
            }
        }


        function update2113(){
            var table2113 = document.getElementById('ind2113Table');

            var rowLength2113 = table2113.rows.length;
            var idxRowInput = 0;
            var mtTot1 = 0;
            var mtTot2 = 0;
            var mtTot3 = 0;
            var mtTot4 = 0;
            var mtTot5 = 0;
            var mtTot6 = 0;
            var mtTot7 = 0;
            var mtTot8 = 0;
            var mtTot9 = 0;
            var mtTot10 = 0;

            for(var i=2; i<rowLength2113; i+=1){
                // contenu de la ligne entière
                var row = table2113.rows[i];
                // nombre de cellule sur la ligne
                var cellLength = row.cells.length;

                var lineTotal = false;
                var lineTot1 = 0;

                if(row.id.substring(0, 5)=="total") {
                    lineTotal = true;

                    for(var y=0; y<cellLength; y+=1){
                        var cell = row.cells[y];
                        if(y==1) {
                            cell.innerHTML = mtTot1;
                            lineTot1 += mtTot1;
                            mtTot1 = 0;
                        }
                        else if(y==2) {
                            cell.innerHTML = mtTot2;
                            lineTot1 += mtTot2;
                            mtTot2 = 0;
                        }
                        else if(y==3) {
                            cell.innerHTML = mtTot3;
                            lineTot1 += mtTot3;
                            mtTot3 = 0;
                        }
                        else if(y==4) {
                            cell.innerHTML = mtTot4;
                            lineTot1 += mtTot4;
                            mtTot4 = 0;
                        }
                        else if(y==5) {
                            cell.innerHTML = mtTot5;
                            lineTot1 += mtTot5;
                            mtTot5 = 0;
                        }
                        else if(y==6) {
                            cell.innerHTML = mtTot6;
                            lineTot1 += mtTot6;
                            mtTot6 = 0;
                        }
                        else if(y==7) {
                            cell.innerHTML = mtTot7;
                            lineTot1 += mtTot7;
                            mtTot7 = 0;
                        }
                        else if(y==8) {
                            cell.innerHTML = mtTot8;
                            lineTot1 += mtTot8;
                            mtTot8 = 0;
                        }
                        else if(y==9) {
                            cell.innerHTML = mtTot9;
                            lineTot1 += mtTot9;
                            mtTot9 = 0;
                        }
                        else if(y==10) {
                            cell.innerHTML = mtTot10;
                            lineTot1 += mtTot10;
                            mtTot10 = 0;
                        } else if (y == 11) {
                            cell.innerHTML = lineTot1;
                        }

                    }
                }

                lineTot1 = 0;

                for(var y=0; y<cellLength; y+=1){
                    var cell = row.cells[y];

                    if(cell.id.substring(0, 6)=="r21132") {
                        if($('#bscForm211_ind2113s_'+idxRowInput+'_r21132').val()!="") {
                            mtTot2 += parseFloat($('#bscForm211_ind2113s_'+idxRowInput+'_r21132').val());
                            lineTot1 += parseFloat($('#bscForm211_ind2113s_'+idxRowInput+'_r21132').val());
                        }
                    }
                    else if(cell.id.substring(0, 6)=="r21133") {
                        if($('#bscForm211_ind2113s_'+idxRowInput+'_r21133').val()!="") {
                            mtTot3 += parseFloat($('#bscForm211_ind2113s_'+idxRowInput+'_r21133').val());
                            lineTot1 += parseFloat($('#bscForm211_ind2113s_'+idxRowInput+'_r21133').val());
                        }
                    }
                    else if(cell.id.substring(0, 6)=="r21134") {
                        if($('#bscForm211_ind2113s_'+idxRowInput+'_r21134').val()!="") {
                            mtTot4 += parseFloat($('#bscForm211_ind2113s_'+idxRowInput+'_r21134').val());
                            lineTot1 += parseFloat($('#bscForm211_ind2113s_'+idxRowInput+'_r21134').val());
                        }
                    }
                    else if(cell.id.substring(0, 6)=="r21135") {
                        if($('#bscForm211_ind2113s_'+idxRowInput+'_r21135').val()!="") {
                            mtTot5 += parseFloat($('#bscForm211_ind2113s_'+idxRowInput+'_r21135').val());
                            lineTot1 += parseFloat($('#bscForm211_ind2113s_'+idxRowInput+'_r21135').val());
                        }
                    }
                    else if(cell.id.substring(0, 6)=="r21136") {
                        if($('#bscForm211_ind2113s_'+idxRowInput+'_r21136').val()!="") {
                            mtTot6 += parseFloat($('#bscForm211_ind2113s_'+idxRowInput+'_r21136').val());
                            lineTot1 += parseFloat($('#bscForm211_ind2113s_'+idxRowInput+'_r21136').val());
                        }
                    }
                    else if(cell.id.substring(0, 6)=="r21137") {
                        if($('#bscForm211_ind2113s_'+idxRowInput+'_r21137').val()!="") {
                            mtTot7 += parseFloat($('#bscForm211_ind2113s_'+idxRowInput+'_r21137').val());
                            lineTot1 += parseFloat($('#bscForm211_ind2113s_'+idxRowInput+'_r21137').val());
                        }
                    }
                    else if(cell.id.substring(0, 6)=="r21138") {
                        if($('#bscForm211_ind2113s_'+idxRowInput+'_r21138').val()!="") {
                            mtTot8 += parseFloat($('#bscForm211_ind2113s_'+idxRowInput+'_r21138').val());
                            lineTot1 += parseFloat($('#bscForm211_ind2113s_'+idxRowInput+'_r21138').val());
                        }
                    }
                    else if(cell.id.substring(0, 6)=="r21139") {
                        if($('#bscForm211_ind2113s_'+idxRowInput+'_r21139').val()!="") {
                            mtTot9 += parseFloat($('#bscForm211_ind2113s_'+idxRowInput+'_r21139').val());
                            lineTot1 += parseFloat($('#bscForm211_ind2113s_'+idxRowInput+'_r21139').val());
                        }
                    }
                    else if(cell.id.substring(0, 7)=="r211310") {
                        if($('#bscForm211_ind2113s_'+idxRowInput+'_r211310').val()!="") {
                            mtTot10 += parseFloat($('#bscForm211_ind2113s_'+idxRowInput+'_r211310').val());
                            lineTot1 += parseFloat($('#bscForm211_ind2113s_'+idxRowInput+'_r211310').val());
                        }
                    }
                    else if(cell.id.substring(0, 6)=="r21131") {
                        if($('#bscForm211_ind2113s_'+idxRowInput+'_r21131').val()!="") {
                            mtTot1 += parseFloat($('#bscForm211_ind2113s_'+idxRowInput+'_r21131').val());
                            lineTot1 += parseFloat($('#bscForm211_ind2113s_'+idxRowInput+'_r21131').val());
                        }
                    } else if (cell.id.substring(0, 8) == "lineTot1") {
                        cell.innerHTML = lineTot1;
                    }

                }

                if(!lineTotal) idxRowInput++;
            }
        }



        /*
         * METHODE AJAX SUBMIT
         */
        $(function () {
            // Enregistrement en ajax
            $('form').on('submit', function (e) {
                var $this = $(this).closest('div');
                var btn = $(this).find("input[type=submit]:focus");
                var value_valide = $(btn).data('valide');
                $('#bscForm211_valide').val(value_valide);
                // Submit en ajax pour le fonctionnement d'appel par onglet
                e.preventDefault();

                $.ajax({
                    type: 'post',
                    url: '{{ path('bilan_conso_tpstrav_ind211_edit') }}',
                    data: $('form').serialize(),
                    success: function (responsejson) {

                        if (responsejson.data == 1) {
                            if (recordAuto) {
                                $('#progImg').hide();
                                $('#messageJS').html("Enregistrement automatique réussi");
                                messageJS.dialog("open");
                                setIncoherenceTable(responsejson);
                            } else {
                                $('#ind211').load('{{ path('bilan_conso_tpstrav_ind211_edit') }}', function () {
                                    $('#progImg').hide();
                                    $('#messageJS').html("Enregistrement réussi");
                                    messageJS.dialog("open");
                                    setIncoherenceTable(responsejson);

                                    var next = $($this).next('.panel-heading');
                                    if(next.length == 0) {
                                        window.location.href = '{{ path('bilan_conso_remuneration_edit') }}';
                                    }
                                });

                            }
                        } else if (responsejson.data == "-3") {
                            $('#progImg').hide();
                            $('#messageJS').html("{{'erreur.unique.violation'|trans}}");
                            messageJS.dialog("open");
                        } else {
                            $('#progImg').hide();
                            $('#messageJS').html("Une erreur s'est produite dans l'enregistrement 1");
                            messageJS.dialog("open");
                        }


                    },
                    error: function (xhr, status, error) {
                        //alert(xhr);
                        $('#progImg').hide();
                        $('#messageJS').html("Une erreur s'est produite dans l'enregistrement 2 ");
                        messageJS.dialog("open");
                    }

                });

            });

        });

        </script>
    {% endif %}


