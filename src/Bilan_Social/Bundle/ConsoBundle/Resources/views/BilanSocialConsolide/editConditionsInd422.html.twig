    {% set campagne = campagne_service.GetCurrentCampagne() %}
    {% set AnneeCamp = '' %}
    {% if campagne is not null %}
        {% set AnneeCamp = campagne.nmAnne %}
    {% endif %}


    {% if formConditions422 is defined %}
        {% set bilan_social_consolide = formConditions422.vars.data %}
        {{ form_start(formConditions422) }}

        {{ form_row(formConditions422.q422) }}

        <div id="ind422b" style="display: none;">

            <table width="100%" id="ind422Table" class="table table-striped table-hover table-bordered">
                <thead>
                    <tr entete="1">
                        <th width="20%" rowspan="3">Cadres d'emplois</th>
                        <th colspan="3" style="text-align: center">Nombre de maladies professionnelles ou à caractère professionnel ou contractées en service reconnues dans l'année {{AnneeCamp}} </th>
                        <th colspan="3" style="text-align: center">Nombre de maladies professionnelles ou à caractère professionnel ou contractées en service reconnues dans les années antérieures ayant entraînées des jours d'arrêt dans l'année {{AnneeCamp}}</th>
                        <th colspan="6" style="text-align: center">Nombre de jours d'arrêts de travail
                            <br/>
                            <span class="alerteConso">[2.1.1.1] + [2.1.2.1] + [2.1.3.1] Homme = {{ total21XH_1 }}</span>
                            <br/>
                            <span class="alerteConso">[2.1.1.1] + [2.1.2.1] + [2.1.3.1] Femme = {{ total21XF_1 }}</span>
                        </th>
                    </tr>

                    <tr entete="1">
                        <th rowspan="2" style="text-align: center">Hommes</th>
                        <th rowspan="2" style="text-align: center">Femmes</th>
                        <th rowspan="2" class="filiTable">Total</th>
                        <th rowspan="2" style="text-align: center">Hommes</th>
                        <th rowspan="2" style="text-align: center">Femmes</th>
                        <th rowspan="2" class="filiTable">Total</th>
                        <th colspan="3" style="text-align: center">Nombre de jours d'arrêt dus à des MP reconnues dans l'année en fonction du sexe</th>
                        <th colspan="3" style="text-align: center">Nombre de jours d'arrêt dans l'année dus à des MP reconnues dans les années antérieures en fonction du sexe</th>
                    </tr>

                    <tr entete="1">
                        <th style="text-align: center">Hommes</th>
                        <th style="text-align: center">Femmes</th>
                        <th class="filiTable">Total</th>
                        <th style="text-align: center">Hommes</th>
                        <th style="text-align: center">Femmes</th>
                        <th class="filiTable">Total</th>
                    </tr>

                </thead>
                <tbody id="422tbody" class="ind_table_totaux">
                    {% for tagF in filieres %}

                        <tr id="entetFil" hide="1" idFili="{{ tagF.idFili }}" style="text-align: center" >
                            <td colspan="21">
                                &nbsp;&nbsp;&nbsp;&nbsp;{{ tagF.lbFili }}
                                {% for key,tot in arrayTotalFiliere %}
                                    {% if(key == tagF.idFili) %}
                                        <span class="alerteConso">[{% if(tot) == null %} 0 {% else %} {{ tot }} {% endif %}]</span>
                                    {% endif %}
                                {% endfor %}
                                {% if idFili == tagF.idFili%}
                                    <input class="buttonmoins" type="button" id="toggle422_{{ tagF.idFili}}"
                                           onclick="toggleFiliere422(this, {{ tagF.idFili}})">
                                {% endif%}

                                {% if idFili != tagF.idFili%}
                                    <input class="buttonplus" type="button" id="toggle422_{{ tagF.idFili}}"
                                           onclick="toggleFiliere422(this, {{ tagF.idFili}})">
                                {% endif%}
                            </td>
                        </tr>

                        {% if idFili == tagF.idFili%}
                            {% for tag in formConditions422.ind422sTemp %}
                                {% set row_data = tag.vars.value %}
                                {% set total_row_nmp = row_data.r4221 + row_data.r4222 %}
                                {% set total_row_nmpaa = row_data.r4223 + row_data.r4224 %}
                                {% set total_row_nj = row_data.r4225 + row_data.r4226 %}
                                {% set total_row_njaa = row_data.r4227 + row_data.r4228 %}
                                <tr  id="422trCE_{{tag.refCadreEmploi.vars.value}}" lineData="1">
                                    <td>
                                        {{ form_widget(tag.refCadreEmploi) }}
                                        {{ tag.refCadreEmploi.vars.data.lbCadrempl }}
                                    </td>
                                    <td id="r4221" style="text-align: center" data-col-group="row_nmp">{{ form_widget(tag.r4221) }}</td>
                                    <td id="r4222" style="text-align: center" data-col-group="row_nmp">{{ form_widget(tag.r4222) }}</td>
                                    <td data-col-id="row_nmp">{{ total_row_nmp }}</td>
                                    <td id="r4223" style="text-align: center" data-col-group="row_nmpaa">{{ form_widget(tag.r4223) }}</td>
                                    <td id="r4224" style="text-align: center" data-col-group="row_nmpaa">{{ form_widget(tag.r4224) }}</td>
                                    <td data-col-id="row_nmpaa">{{ total_row_nmpaa }}</td>
                                    <td id="r4225" style="text-align: center" data-col-group="row_nj">{{ form_widget(tag.r4225) }}</td>
                                    <td id="r4226" style="text-align: center" data-col-group="row_nj">{{ form_widget(tag.r4226) }}</td>
                                    <td data-col-id="row_nj">{{ total_row_nj }}</td>
                                    <td id="r4227" style="text-align: center" data-col-group="row_njaa">{{ form_widget(tag.r4227) }}</td>
                                    <td id="r4228" style="text-align: center" data-col-group="row_njaa">{{ form_widget(tag.r4228) }}</td>
                                    <td data-col-id="row_njaa">{{ total_row_njaa }}</td>

                                </tr>

                            {% endfor %}
                            {% set total_fili = bilan_social_consolide.getIndPileForBy('ind422sTemp',['refCadreEmploi','refFiliere','idFili'],idFili) %}
                            {% set total_fili_row_nmp = total_fili.r4221 + total_fili.r4222 %}
                            {% set total_fili_row_nmpaa = total_fili.r4223 + total_fili.r4224 %}
                            {% set total_fili_row_nj = total_fili.r4225 + total_fili.r4226 %}
                            {% set total_fili_row_njaa = total_fili.r4227 + total_fili.r4228 %}
                            <tr class="filiTable row_totaux" id="totalFil">
                                <td><b>Total {{ tagF.lbFili}} </b></td>
                                <td style="text-align: center" data-col-group="fili_nmp">{{ total_fili.r4221 }}</td>
                                <td style="text-align: center" data-col-group="fili_nmp">{{ total_fili.r4222 }}</td>
                                <td data-col-id="row_nmp">{{ total_fili_row_nmp }}</td>
                                <td style="text-align: center" data-col-group="fili_nmpaa">{{ total_fili.r4223 }}</td>
                                <td style="text-align: center" data-col-group="fili_nmpaa">{{ total_fili.r4224 }}</td>
                                <td data-col-id="row_nmpaa">{{ total_fili_row_nmpaa }}</td>
                                <td style="text-align: center" data-col-group="fili_nj">{{ total_fili.r4225 }}</td>
                                <td style="text-align: center" data-col-group="fili_nj">{{ total_fili.r4226 }}</td>
                                <td data-col-id="row_nj">{{ total_fili_row_nj }}</td>
                                <td style="text-align: center" data-col-group="fili_njaa">{{ total_fili.r4227 }}</td>
                                <td style="text-align: center" data-col-group="fili_njaa">{{ total_fili.r4228 }}</td>
                                <td data-col-id="row_njaa">{{ total_fili_row_njaa }}</td>

                            </tr>

                        {% endif %}

                    {% endfor %}

                    {#<tr id="totalHorsFil" class="filiTable" style="display: none">
                        <td></td>
                        <td style="text-align: center">{{totalInd422.r4221}}</td>
                        <td style="text-align: center">{{totalInd422.r4222}}</td>
                        <td style="text-align: center">{{totalInd422.r4223}}</td>
                        <td style="text-align: center">{{totalInd422.r4224}}</td>
                        <td style="text-align: center">{{totalInd422.r4225}}</td>
                        <td style="text-align: center">{{totalInd422.r4226}}</td>
                        <td style="text-align: center">{{totalInd422.r4227}}</td>
                        <td style="text-align: center">{{totalInd422.r4228}}</td>
                    </tr>#}
                    {% set total_all_fili = bilan_social_consolide.getIndPileForBy('ind422s',['refCadreEmploi','refFiliere','cdFili'],['AOTM','H','HH'],{'exclude':true}) %}
                    {% set total_all_fili_row_nmp = total_all_fili.r4221 + total_all_fili.r4222 %}
                    {% set total_all_fili_row_nmpaa = total_all_fili.r4223 + total_all_fili.r4224 %}
                    {% set total_all_fili_row_nj = total_all_fili.r4225 + total_all_fili.r4226 %}
                    {% set total_all_fili_row_njaa = total_all_fili.r4227 + total_all_fili.r4228 %}
                    <tr id="totalFilGlo" class="filiTable row_totaux">
                        <td><b>TOUTES FILIERES</b></td>
                        <td style="text-align: center" data-col-group="all_fili_nmp">{{ total_all_fili.r4221 }}</td>
                        <td style="text-align: center" data-col-group="all_fili_nmp">{{ total_all_fili.r4222 }}</td>
                        <td data-col-id="all_fili_nmp">{{ total_all_fili_row_nmp }}</td>
                        <td style="text-align: center" data-col-group="all_fili_nmpaa">{{ total_all_fili.r4223 }}</td>
                        <td style="text-align: center" data-col-group="all_fili_nmpaa">{{ total_all_fili.r4224 }}</td>
                        <td data-col-id="all_fili_nmpaa">{{ total_all_fili_row_nmpaa }}</td>
                        <td style="text-align: center" data-col-group="all_fili_nj">{{ total_all_fili.r4225 }}</td>
                        <td style="text-align: center" data-col-group="all_fili_nj">{{ total_all_fili.r4226 }}</td>
                        <td data-col-id="all_fili_nj">{{ total_all_fili_row_nj }}</td>
                        <td style="text-align: center" data-col-group="all_fili_njaa">{{ total_all_fili.r4227 }}</td>
                        <td style="text-align: center" data-col-group="all_fili_njaa">{{ total_all_fili.r4228 }}</td>
                        <td data-col-id="all_fili_njaa">{{ total_all_fili_row_njaa }}</td>
                    </tr>

                    {% for tag in formConditions422.ind422AotmsTemp %}
                        {% set row_data = tag.vars.value %}
                        {% set total_aotm_nmp = row_data.r4221 + row_data.r4222 %}
                        {% set total_aotm_nmpaa = row_data.r4223 + row_data.r4224 %}
                        {% set total_aotm_nj = row_data.r4225 + row_data.r4226 %}
                        {% set total_aotm_njaa = row_data.r4227 + row_data.r4228 %}
                        <tr  id="422trCE_{{tag.refCadreEmploi.vars.value}}" lineAotm="1">
                            <td>
                                {{ form_widget(tag.refCadreEmploi) }}
                                {{ tag.refCadreEmploi.vars.data.lbCadrempl }}
                            </td>
                            <td id="r4221" style="text-align: center" data-col-group="total_aotm_nmp">{{ form_widget(tag.r4221) }}</td>
                            <td id="r4222" style="text-align: center" data-col-group="total_aotm_nmp">{{ form_widget(tag.r4222) }}</td>
                            <td data-col-id="total_aotm_nmp">{{ total_aotm_nmp }}</td>
                            <td id="r4223" style="text-align: center" data-col-group="total_aotm_nmpaa">{{ form_widget(tag.r4223) }}</td>
                            <td id="r4224" style="text-align: center" data-col-group="total_aotm_nmpaa">{{ form_widget(tag.r4224) }}</td>
                            <td data-col-id="total_aotm_nmpaa">{{ total_aotm_nmpaa }}</td>
                            <td id="r4225" style="text-align: center" data-col-group="total_aotm_nj">{{ form_widget(tag.r4225) }}</td>
                            <td id="r4226" style="text-align: center" data-col-group="total_aotm_nj">{{ form_widget(tag.r4226) }}</td>
                            <td data-col-id="total_aotm_nj">{{ total_aotm_nj }}</td>
                            <td id="r4227" style="text-align: center" data-col-group="total_aotm_njaa">{{ form_widget(tag.r4227) }}</td>
                            <td id="r4228" style="text-align: center" data-col-group="total_aotm_njaa">{{ form_widget(tag.r4228) }}</td>
                            <td data-col-id="total_aotm_njaa">{{ total_aotm_njaa }}</td>

                        </tr>

                    {% endfor %}

                    {% for tag in formConditions422.ind422HsTemp %}
                        {% set row_data = tag.vars.value %}
                        {% set total_hs_nmp = row_data.r4221 + row_data.r4222 %}
                        {% set total_hs_nmpaa = row_data.r4223 + row_data.r4224 %}
                        {% set total_hs_nj = row_data.r4225 + row_data.r4226 %}
                        {% set total_hs_njaa = row_data.r4227 + row_data.r4228 %}
                        <tr  id="422trCE_{{tag.refCadreEmploi.vars.value}}" lineHF="1">
                            <td>
                                {{ form_widget(tag.refCadreEmploi) }}
                                {{ tag.refCadreEmploi.vars.data.lbCadrempl }}
                            </td>
                            <td id="r4221" style="text-align: center" data-col-group="total_hs_nmp">{{ form_widget(tag.r4221) }}</td>
                            <td id="r4222" style="text-align: center" data-col-group="total_hs_nmp">{{ form_widget(tag.r4222) }}</td>
                            <td data-col-id="total_hs_nmp">{{ total_hs_nmp }}</td>
                            <td id="r4223" style="text-align: center" data-col-group="total_hs_nmpaa">{{ form_widget(tag.r4223) }}</td>
                            <td id="r4224" style="text-align: center" data-col-group="total_hs_nmpaa">{{ form_widget(tag.r4224) }}</td>
                            <td data-col-id="total_hs_nmpaa">{{ total_hs_nmpaa }}</td>
                            <td id="r4225" style="text-align: center" data-col-group="total_hs_nj">{{ form_widget(tag.r4225) }}</td>
                            <td id="r4226" style="text-align: center" data-col-group="total_hs_nj">{{ form_widget(tag.r4226) }}</td>
                            <td data-col-id="total_hs_nj">{{ total_hs_nj }}</td>
                            <td id="r4227" style="text-align: center" data-col-group="total_hs_njaa">{{ form_widget(tag.r4227) }}</td>
                            <td id="r4228" style="text-align: center" data-col-group="total_hs_njaa">{{ form_widget(tag.r4228) }}</td>
                            <td data-col-id="total_hs_njaa">{{ total_hs_njaa }}</td>

                        </tr>

                    {% endfor %}
                    {% set total_ind = bilan_social_consolide.getIndPileForBy('ind422s') %}
                    {% set total_all_nmp = total_ind.r4221 + total_ind.r4222 %}
                    {% set total_all_nmpaa = total_ind.r4223 + total_ind.r4224 %}
                    {% set total_all_nj = total_ind.r4225 + total_ind.r4226 %}
                    {% set total_all_njaa = total_ind.r4227 + total_ind.r4228 %}
                    <tr id="totalGlo422" class="filiTable row_totaux">
                        <td><b>TOTAL</b></td>
                        <td style="text-align: center" data-col-group="total_ind_nmp">{{ total_ind.r4221 }}</td>
                        <td style="text-align: center" data-col-group="total_ind_nmp">{{ total_ind.r4222 }}</td>
                        <td data-col-id="total_ind_nmp">{{ total_all_nmp }}</td>
                        <td style="text-align: center" data-col-group="total_ind_nmpaa">{{ total_ind.r4223 }}</td>
                        <td style="text-align: center" data-col-group="total_ind_nmpaa">{{ total_ind.r4224 }}</td>
                        <td data-col-id="total_ind_nmpaa">{{ total_all_nmpaa }}</td>
                        <td style="text-align: center" data-col-group="total_ind_nj">{{ total_ind.r4225 }}</td>
                        <td style="text-align: center" data-col-group="total_ind_nj">{{ total_ind.r4226 }}</td>
                        <td data-col-id="total_ind_nj">{{ total_all_nj }}</td>
                        <td style="text-align: center" data-col-group="total_ind_njaa">{{ total_ind.r4227 }}</td>
                        <td style="text-align: center" data-col-group="total_ind_njaa">{{ total_ind.r4228 }}</td>
                        <td data-col-id="total_ind_njaa">{{ total_all_njaa }}</td>
                    </tr>

                </tbody>
            </table>
        </div>

        <br/>


        <input class="btn button-tableau pull-right" type="submit" value="Enregistrer et valider les contrôles de cohérence" name="valider" onclick="recordAuto = false;
                $('#progImg').show();" data-valide="1" />

        <img id="progImg" src="{{ asset("img/progress.gif") }}" style="display:none"/>

        {{ form_end(formConditions422) }}

        <script type="text/javascript">
            $(document).ready(function ()
            {
                changeDetect = false;
                {% include 'stickyheader.txt' %}
                getBrowserSetSticky(ind422Table);
                
                initForm422();
                $("#bscForm422_q422").on("click", function () {
                    initForm422();
                });

                $(document).change();
                //update422();

            });


                function initForm422() {
                    var q422Res = $('input[name="bscForm422[q422]"]').filter(':checked').val();

                    if (q422Res == "1") {
                        $('#ind422b').show();
                    } else {
                        $('#ind422b').hide();
                    }
                }

                function initLight422() {
                    if (incoherenceList != undefined) {
                        // Si le json js a été chargé  (via un eneregistrement) => light via le json
                        for (var idx in incoherenceList) {
                            var incoh = incoherenceList[idx];
                            if (incoh.tableNum == '4.2.2') {
                                lightError(incoh.field, incoh.incoherence);
                            }
                        }
                    } else {
                        // si premier acces à la page => light via le twig

                        {% for tag in incoherenceList %}
                            {% if tag.tableNum == '4.2.2' %}
                            lightError('{{tag.field}}', {{tag.blIncoherence}});
                            {% endif %}
                        {% endfor %}

                    }
                }

                function forceQ422ToYes() {
                    $('#bscForm422_q422_0').attr('checked', 'checked');
                    $('#bscForm422_q422_1').removeAttr('checked');
                    $('#ind422b').show();
                }

                /*
                 * METHODES Tableau 4.2.2
                 */

                function toggleFiliere422(toggleObj, pidFili) {
                    var css = toggleObj.getAttribute('class');

                {% if idFili != null and idFili != 0 %}
                        // Sauvegarde auto
                        if (currentTab != "")
                            saveTab(currentTab);
                {% endif %}

                        if (css == "buttonplus") {
                            $('#ind422').load('{{ path('bilan_conso_conditions_ind422_edit') }}?idFili=' + pidFili, function () {
                                initLight422();
                                forceQ422ToYes();
                                disabled();
                            });

                        } else {
                            $('#ind422').load('{{ path('bilan_conso_conditions_ind422_edit') }}?idFili=' + 0, function () {
                                initLight422();
                                forceQ422ToYes();
                                disabled();
                            });

                        }
                    }

                    function changedR422(obj) {
                        //update422();
                    }


                    function update422() {
                        var table422 = document.getElementById('ind422Table');

                        var rowLength422 = table422.rows.length;
                        var idxRowInput = 0;
                        var idxRowInputAotm = 0;
                        var idxRowInputHF = 0;

                        var mtTot1 = 0;
                        var mtTot2 = 0;
                        var mtTot3 = 0;
                        var mtTot4 = 0;
                        var mtTot5 = 0;
                        var mtTot6 = 0;
                        var mtTot7 = 0;
                        var mtTot8 = 0;

                        var mtTot1Fil = 0;
                        var mtTot2Fil = 0;
                        var mtTot3Fil = 0;
                        var mtTot4Fil = 0;
                        var mtTot5Fil = 0;
                        var mtTot6Fil = 0;
                        var mtTot7Fil = 0;
                        var mtTot8Fil = 0;

                        var mtTot1FilGlo = 0;
                        var mtTot2FilGlo = 0;
                        var mtTot3FilGlo = 0;
                        var mtTot4FilGlo = 0;
                        var mtTot5FilGlo = 0;
                        var mtTot6FilGlo = 0;
                        var mtTot7FilGlo = 0;
                        var mtTot8FilGlo = 0;

                        var mtTot1HorsFil = 0;
                        var mtTot2HorsFil = 0;
                        var mtTot3HorsFil = 0;
                        var mtTot4HorsFil = 0;
                        var mtTot5HorsFil = 0;
                        var mtTot6HorsFil = 0;
                        var mtTot7HorsFil = 0;
                        var mtTot8HorsFil = 0;



                        var mtTot1Glo = 0;
                        var mtTot2Glo = 0;
                        var mtTot3Glo = 0;
                        var mtTot4Glo = 0;
                        var mtTot5Glo = 0;
                        var mtTot6Glo = 0;
                        var mtTot7Glo = 0;
                        var mtTot8Glo = 0;

                        for (var i = 0; i < rowLength422; i += 1) {
                            var row = table422.rows[i];

                            if(row.getAttribute("entete") != undefined && row.getAttribute("entete") == "1") {
                                continue;
                            }

                            var lineAotm = false;
                            var lineData = false;
                            var lineHF = false;

                            if(row.getAttribute("lineAotm") != undefined) {
                                lineAotm = true;
                            }
                            if(row.getAttribute("lineData") != undefined) {
                                lineData = true;
                            }
                            if(row.getAttribute("lineHF") != undefined) {
                                lineHF = true;
                            }

                            var cellLength = row.cells.length;

                            var lineTotalFil = false;
                            var lineTotalFilGlo = false;

                            if (row.id.substring(0, 8) == "entetFil") {
                                continue;
                            }

                            if (row.id.substring(0, 12) == "totalHorsFil") {
                                for (var y = 0; y < cellLength; y += 1) {
                                    var cell = row.cells[y];
                                    if (y == 1) {
                                        mtTot1HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 2) {
                                        mtTot2HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 3) {
                                        mtTot3HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 4) {
                                        mtTot4HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 5) {
                                        mtTot5HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 6) {
                                        mtTot6HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 7) {
                                        mtTot7HorsFil = parseInt(cell.innerHTML);
                                    } else if (y == 8) {
                                        mtTot8HorsFil = parseInt(cell.innerHTML);
                                    }
                                }
                            }

                            if (row.id.substring(0, 11) == "totalFilGlo") {
                                lineTotalFilGlo = true;
                                for (var y = 0; y < cellLength; y += 1) {
                                    var cell = row.cells[y];
                                    if (y == 1) {
                                        cell.innerHTML = mtTot1FilGlo + mtTot1HorsFil;
                                        mtTot1FilGlo = 0;
                                    } else if (y == 2) {
                                        cell.innerHTML = mtTot2FilGlo + mtTot2HorsFil;
                                        mtTot2FilGlo = 0;
                                    } else if (y == 3) {
                                        cell.innerHTML = mtTot3FilGlo + mtTot3HorsFil;
                                        mtTot3FilGlo = 0;
                                    } else if (y == 4) {
                                        cell.innerHTML = mtTot4FilGlo + mtTot4HorsFil;
                                        mtTot4FilGlo = 0;
                                    } else if (y == 5) {
                                        cell.innerHTML = mtTot5FilGlo + mtTot5HorsFil;
                                        mtTot5FilGlo = 0;
                                    } else if (y == 6) {
                                        cell.innerHTML = mtTot6FilGlo + mtTot6HorsFil;
                                        mtTot6FilGlo = 0;
                                    } else if (y == 7) {
                                        cell.innerHTML = mtTot7FilGlo + mtTot7HorsFil;
                                        mtTot7FilGlo = 0;
                                    } else if (y == 8) {
                                        cell.innerHTML = mtTot8FilGlo + mtTot8HorsFil;
                                        mtTot8FilGlo = 0;
                                    }
                                }
                            } else if (row.id.substring(0, 8) == "totalFil") {
                                lineTotalFil = true;
                                for (var y = 0; y < cellLength; y += 1) {
                                    var cell = row.cells[y];
                                    if (y == 1) {
                                        cell.innerHTML = mtTot1Fil;
                                        mtTot1Fil = 0;
                                    } else if (y == 2) {
                                        cell.innerHTML = mtTot2Fil;
                                        mtTot2Fil = 0;
                                    } else if (y == 3) {
                                        cell.innerHTML = mtTot3Fil;
                                        mtTot3Fil = 0;
                                    } else if (y == 4) {
                                        cell.innerHTML = mtTot4Fil;
                                        mtTot4Fil = 0;
                                    } else if (y == 5) {
                                        cell.innerHTML = mtTot5Fil;
                                        mtTot5Fil = 0;
                                    } else if (y == 6) {
                                        cell.innerHTML = mtTot6Fil;
                                        mtTot6Fil = 0;
                                    } else if (y == 7) {
                                        cell.innerHTML = mtTot7Fil;
                                        mtTot7Fil = 0;
                                    } else if (y == 8) {
                                        cell.innerHTML = mtTot8Fil;
                                        mtTot8Fil = 0;
                                    }
                                }
                            }

                            if (row.id.substring(0, 8) == "totalGlo") {
                                for (var y = 0; y < cellLength; y += 1) {
                                    var cell = row.cells[y];
                                    if (y == 1) {
                                        cell.innerHTML = mtTot1Glo + mtTot1HorsFil;
                                        mtTot1Glo = 0;
                                    } else if (y == 2) {
                                        cell.innerHTML = mtTot2Glo + mtTot2HorsFil;
                                        mtTot2Glo = 0;
                                    } else if (y == 3) {
                                        cell.innerHTML = mtTot3Glo + mtTot3HorsFil;
                                        mtTot3Glo = 0;
                                    } else if (y == 4) {
                                        cell.innerHTML = mtTot4Glo + mtTot4HorsFil;
                                        mtTot4Glo = 0;
                                    } else if (y == 5) {
                                        cell.innerHTML = mtTot5Glo + mtTot5HorsFil;
                                        mtTot5Glo = 0;
                                    } else if (y == 6) {
                                        cell.innerHTML = mtTot6Glo + mtTot6HorsFil;
                                        mtTot6Glo = 0;
                                    } else if (y == 7) {
                                        cell.innerHTML = mtTot7Glo + mtTot7HorsFil;
                                        mtTot7Glo = 0;
                                    } else if (y == 8) {
                                        cell.innerHTML = mtTot8Glo + mtTot8HorsFil;
                                        mtTot8Glo = 0;
                                    }
                                }
                            }

                            for (var y = 0; y < cellLength; y += 1) {
                                var cell = row.cells[y];
                                var cellValue;

                                if (cell.id.substring(0, 5) == "r4222") {
                                    cellValue = $('#bscForm422_ind422' + (lineAotm ? 'Aotm' : (lineHF ? 'H' : '')) + 'sTemp_' + (lineAotm ? idxRowInputAotm : (lineHF ? idxRowInputHF : idxRowInput)) + '_r4222').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);

                                        if(!lineAotm && !lineHF) {
                                            mtTot2 += cellValue;
                                            mtTot2Fil += cellValue;
                                            mtTot2FilGlo += cellValue;
                                        }
                                        mtTot2Glo += cellValue;
                                    }
                                    //if ($('#bscForm422_ind422sTemp_' + idxRowInput + '_r4222').val() != "") {
                                    //    mtTot2 += parseInt($('#bscForm422_ind422sTemp_' + idxRowInput + '_r4222').val());
                                    //    mtTot2Fil += parseInt($('#bscForm422_ind422sTemp_' + idxRowInput + '_r4222').val());
                                    //    mtTot2FilGlo += parseInt($('#bscForm422_ind422sTemp_' + idxRowInput + '_r4222').val());
                                    //}
                                } else if (cell.id.substring(0, 5) == "r4223") {
                                    cellValue = $('#bscForm422_ind422' + (lineAotm ? 'Aotm' : (lineHF ? 'H' : '')) + 'sTemp_' + (lineAotm ? idxRowInputAotm : (lineHF ? idxRowInputHF : idxRowInput)) + '_r4223').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);

                                        if(!lineAotm && !lineHF) {
                                            mtTot3 += cellValue;
                                            mtTot3Fil += cellValue;
                                            mtTot3FilGlo += cellValue;
                                        }
                                        mtTot3Glo += cellValue;
                                    }
                                } else if (cell.id.substring(0, 5) == "r4224") {
                                    cellValue = $('#bscForm422_ind422' + (lineAotm ? 'Aotm' : (lineHF ? 'H' : '')) + 'sTemp_' + (lineAotm ? idxRowInputAotm : (lineHF ? idxRowInputHF : idxRowInput)) + '_r4224').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);

                                        if(!lineAotm && !lineHF) {
                                            mtTot4 += cellValue;
                                            mtTot4Fil += cellValue;
                                            mtTot4FilGlo += cellValue;
                                        }
                                        mtTot4Glo += cellValue;
                                    }
                                } else if (cell.id.substring(0, 5) == "r4225") {
                                    cellValue = $('#bscForm422_ind422' + (lineAotm ? 'Aotm' : (lineHF ? 'H' : '')) + 'sTemp_' + (lineAotm ? idxRowInputAotm : (lineHF ? idxRowInputHF : idxRowInput)) + '_r4225').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);

                                        if(!lineAotm && !lineHF) {
                                            mtTot5 += cellValue;
                                            mtTot5Fil += cellValue;
                                            mtTot5FilGlo += cellValue;
                                        }
                                        mtTot5Glo += cellValue;
                                    }
                                } else if (cell.id.substring(0, 5) == "r4226") {
                                    cellValue = $('#bscForm422_ind422' + (lineAotm ? 'Aotm' : (lineHF ? 'H' : '')) + 'sTemp_' + (lineAotm ? idxRowInputAotm : (lineHF ? idxRowInputHF : idxRowInput)) + '_r4226').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);

                                        if(!lineAotm && !lineHF) {
                                            mtTot6 += cellValue;
                                            mtTot6Fil += cellValue;
                                            mtTot6FilGlo += cellValue;
                                        }
                                        mtTot6Glo += cellValue;
                                    }
                                } else if (cell.id.substring(0, 5) == "r4227") {
                                    cellValue = $('#bscForm422_ind422' + (lineAotm ? 'Aotm' : (lineHF ? 'H' : '')) + 'sTemp_' + (lineAotm ? idxRowInputAotm : (lineHF ? idxRowInputHF : idxRowInput)) + '_r4227').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);

                                        if(!lineAotm && !lineHF) {
                                            mtTot7 += cellValue;
                                            mtTot7Fil += cellValue;
                                            mtTot7FilGlo += cellValue;
                                        }
                                        mtTot7Glo += cellValue;
                                    }
                                } else if (cell.id.substring(0, 5) == "r4228") {
                                    cellValue = $('#bscForm422_ind422' + (lineAotm ? 'Aotm' : (lineHF ? 'H' : '')) + 'sTemp_' + (lineAotm ? idxRowInputAotm : (lineHF ? idxRowInputHF : idxRowInput)) + '_r4228').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);

                                        if(!lineAotm && !lineHF) {
                                            mtTot8 += cellValue;
                                            mtTot8Fil += cellValue;
                                            mtTot8FilGlo += cellValue;
                                        }
                                        mtTot8Glo += cellValue;
                                    }
                                } else if (cell.id.substring(0, 5) == "r4221") {
                                    //alert('#bscForm422_ind422sTemp_' + idxRowInput + '_r4221');
                                    cellValue = $('#bscForm422_ind422' + (lineAotm ? 'Aotm' : (lineHF ? 'H' : '')) + 'sTemp_' + (lineAotm ? idxRowInputAotm : (lineHF ? idxRowInputHF : idxRowInput)) + '_r4221').val();
                                    if (cellValue != "") {
                                        cellValue = parseInt(cellValue);

                                        if(!lineAotm && !lineHF) {
                                            mtTot1 += cellValue;
                                            mtTot1Fil += cellValue;
                                            mtTot1FilGlo += cellValue;
                                        }
                                        mtTot1Glo += cellValue;
                                    }
                                }
                            }

                            if (lineData) idxRowInput++;
                            if (lineAotm) idxRowInputAotm++;
                            if (lineHF) idxRowInputHF++;

                        }// end for line

                    }




                /*
                 * METHODE AJAX SUBMIT
                 */
                $(function () {
                    // Enregistrement en ajax
                    $('form').on('submit', function (e) {
                        var $this = $(this).closest('div');
                        var btn = $(this).find("input[type=submit]:focus");
                        var value_valide = $(btn).data('valide');
                        var qRes422 = $('input[name="bscForm422[q422]"]').filter(':checked').val();
                        var Res422Status = checkIfZeroOrNull(qRes422, 'ind422Table', 'ind422b');
                        $('#bscForm422_valide').val(value_valide);
                        // Submit en ajax pour le fonctionnement d'appel par onglet
                        e.preventDefault();
                        if (Res422Status == true) {
                            $.ajax({
                                type: 'post',
                                url: '{{ path('bilan_conso_conditions_ind422_edit') }}?idFili={{idFili}}',
                                data: $('form').serialize(),
                                success: function (responsejson) {

                                    if (responsejson.data == 1) {
                                        if (recordAuto) {
                                            $('#progImg').hide();
                                            $('#messageJS').html("Enregistrement automatique réussi");
                                            messageJS.dialog("open");
                                            setIncoherenceTable(responsejson);
                                        } else {
                                            $('#ind422').load('{{ path('bilan_conso_conditions_ind422_edit') }}?idFili={{idFili}}', function () {
                                                $('#progImg').hide();
                                                $('#messageJS').html("Enregistrement réussi");
                                                messageJS.dialog("open");
                                                setIncoherenceTable(responsejson);

                                                var next = $($this).next('.panel-heading');
                                                if(next.length == 0) {
                                                    window.location.href = '{{ path('bilan_conso_formation_edit') }}';
                                                }
                                            });

                                        }
                                    } else if (responsejson.data == "-3") {
                                        $('#progImg').hide();
                                        $('#messageJS').html("{{'erreur.unique.violation'|trans}}");
                                        messageJS.dialog("open");
                                    } else {
                                        $('#progImg').hide();
                                        $('#messageJS').html("Une erreur s'est produite dans l'enregistrement 1");
                                        messageJS.dialog("open");
                                    }


                                },
                                error: function (xhr, status, error) {
                                    //alert(xhr);
                                    $('#progImg').hide();
                                    $('#messageJS').html("Une erreur s'est produite dans l'enregistrement 2 ");
                                    messageJS.dialog("open");
                                }

                            });
                        } else {
                            $('#progImg').hide();
                        }

                    });

                });

        </script>
    {% endif %}
